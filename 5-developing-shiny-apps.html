<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Developing Shiny Apps | Hosting Shiny Applications for R and Python</title>
  <meta name="description" content="Everything you wanted to know about hosting Shiny apps." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Developing Shiny Apps | Hosting Shiny Applications for R and Python" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://hostingshiny.com//images/logos/book_cover.jpg" />
  <meta property="og:description" content="Everything you wanted to know about hosting Shiny apps." />
  <meta name="github-repo" content="analythium/hosting-shiny-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Developing Shiny Apps | Hosting Shiny Applications for R and Python" />
  <meta name="twitter:site" content="@analythium" />
  <meta name="twitter:description" content="Everything you wanted to know about hosting Shiny apps." />
  <meta name="twitter:image" content="https://hostingshiny.com//images/logos/book_cover.jpg" />

<meta name="author" content="Péter Sólymos and Kalvin Eng" />


<meta name="date" content="2024-07-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="images/logos/favicons/apple-touch-icon.png" />
  <link rel="shortcut icon" href="images/logos/favicons/favicon.ico" type="image/x-icon" />
<link rel="prev" href="4-examples.html"/>
<link rel="next" href="6-containerizing-shiny-apps.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/core-js-2.5.3/shim.min.js"></script>
<script src="libs/react-18.2.0/react.min.js"></script>
<script src="libs/react-18.2.0/react-dom.min.js"></script>
<script src="libs/reactwidget-2.0.0/react-tools.umd.cjs"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/reactable-0.4.4/reactable.css" rel="stylesheet" />
<script src="libs/reactable-binding-0.4.4/reactable.js"></script>
<script>
  // Fathom Analytics code to come here
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="foreword.html"><a href="foreword.html"><i class="fa fa-check"></i>Foreword</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#motivation"><i class="fa fa-check"></i>Motivation</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#who-is-this-book-for"><i class="fa fa-check"></i>Who Is This Book For?</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#what-will-you-learn"><i class="fa fa-check"></i>What Will You Learn?</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#what-will-you-not-learn"><i class="fa fa-check"></i>What Will You Not Learn?</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#conventions"><i class="fa fa-check"></i>Conventions</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#about-the-authors"><i class="fa fa-check"></i>About the Authors</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>I Getting Started</b></span></li>
<li class="chapter" data-level="1" data-path="1-background.html"><a href="1-background.html"><i class="fa fa-check"></i><b>1</b> Background</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1-background.html"><a href="1-background.html#data-intensive-apps"><i class="fa fa-check"></i><b>1.1</b> Data-intensive Apps</a></li>
<li class="chapter" data-level="1.2" data-path="1-background.html"><a href="1-background.html#enter-shiny"><i class="fa fa-check"></i><b>1.2</b> Enter Shiny</a></li>
<li class="chapter" data-level="1.3" data-path="1-background.html"><a href="1-background.html#application-development"><i class="fa fa-check"></i><b>1.3</b> Application Development</a></li>
<li class="chapter" data-level="1.4" data-path="1-background.html"><a href="1-background.html#application-hosting"><i class="fa fa-check"></i><b>1.4</b> Application Hosting</a></li>
<li class="chapter" data-level="1.5" data-path="1-background.html"><a href="1-background.html#the-devops-cycle"><i class="fa fa-check"></i><b>1.5</b> The DevOps Cycle</a></li>
<li class="chapter" data-level="1.6" data-path="1-background.html"><a href="1-background.html#the-hosting-cycle"><i class="fa fa-check"></i><b>1.6</b> The Hosting Cycle</a></li>
<li class="chapter" data-level="1.7" data-path="1-background.html"><a href="1-background.html#summary"><i class="fa fa-check"></i><b>1.7</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-hosting-concepts.html"><a href="2-hosting-concepts.html"><i class="fa fa-check"></i><b>2</b> Hosting Concepts</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2-hosting-concepts.html"><a href="2-hosting-concepts.html#domains-and-networking"><i class="fa fa-check"></i><b>2.1</b> Domains and Networking</a></li>
<li class="chapter" data-level="2.2" data-path="2-hosting-concepts.html"><a href="2-hosting-concepts.html#website-technologies"><i class="fa fa-check"></i><b>2.2</b> Website Technologies</a></li>
<li class="chapter" data-level="2.3" data-path="2-hosting-concepts.html"><a href="2-hosting-concepts.html#servers"><i class="fa fa-check"></i><b>2.3</b> Servers</a></li>
<li class="chapter" data-level="2.4" data-path="2-hosting-concepts.html"><a href="2-hosting-concepts.html#hosting-environments"><i class="fa fa-check"></i><b>2.4</b> Hosting Environments</a></li>
<li class="chapter" data-level="2.5" data-path="2-hosting-concepts.html"><a href="2-hosting-concepts.html#summary-1"><i class="fa fa-check"></i><b>2.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-local-setup.html"><a href="3-local-setup.html"><i class="fa fa-check"></i><b>3</b> Local Setup</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3-local-setup.html"><a href="3-local-setup.html#installing-your-developer-tools"><i class="fa fa-check"></i><b>3.1</b> Installing Your Developer Tools</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="3-local-setup.html"><a href="3-local-setup.html#r"><i class="fa fa-check"></i><b>3.1.1</b> R</a></li>
<li class="chapter" data-level="3.1.2" data-path="3-local-setup.html"><a href="3-local-setup.html#install-python"><i class="fa fa-check"></i><b>3.1.2</b> Install Python</a></li>
<li class="chapter" data-level="3.1.3" data-path="3-local-setup.html"><a href="3-local-setup.html#web-browser"><i class="fa fa-check"></i><b>3.1.3</b> Web Browser</a></li>
<li class="chapter" data-level="3.1.4" data-path="3-local-setup.html"><a href="3-local-setup.html#quarto"><i class="fa fa-check"></i><b>3.1.4</b> Quarto</a></li>
<li class="chapter" data-level="3.1.5" data-path="3-local-setup.html"><a href="3-local-setup.html#docker-desktop"><i class="fa fa-check"></i><b>3.1.5</b> Docker Desktop</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="3-local-setup.html"><a href="3-local-setup.html#the-command-line"><i class="fa fa-check"></i><b>3.2</b> The Command Line</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="3-local-setup.html"><a href="3-local-setup.html#navigation"><i class="fa fa-check"></i><b>3.2.1</b> Navigation</a></li>
<li class="chapter" data-level="3.2.2" data-path="3-local-setup.html"><a href="3-local-setup.html#editing-files"><i class="fa fa-check"></i><b>3.2.2</b> Editing Files</a></li>
<li class="chapter" data-level="3.2.3" data-path="3-local-setup.html"><a href="3-local-setup.html#file-and-directory-operations"><i class="fa fa-check"></i><b>3.2.3</b> File and Directory Operations</a></li>
<li class="chapter" data-level="3.2.4" data-path="3-local-setup.html"><a href="3-local-setup.html#super-user-access"><i class="fa fa-check"></i><b>3.2.4</b> Super User Access</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="3-local-setup.html"><a href="3-local-setup.html#source-code-management-with-git"><i class="fa fa-check"></i><b>3.3</b> Source Code Management with Git</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="3-local-setup.html"><a href="3-local-setup.html#git-services"><i class="fa fa-check"></i><b>3.3.1</b> Git Services</a></li>
<li class="chapter" data-level="3.3.2" data-path="3-local-setup.html"><a href="3-local-setup.html#git-commands"><i class="fa fa-check"></i><b>3.3.2</b> Git Commands</a></li>
<li class="chapter" data-level="3.3.3" data-path="3-local-setup.html"><a href="3-local-setup.html#gitignore"><i class="fa fa-check"></i><b>3.3.3</b> .gitignore</a></li>
<li class="chapter" data-level="3.3.4" data-path="3-local-setup.html"><a href="3-local-setup.html#branching"><i class="fa fa-check"></i><b>3.3.4</b> Branching</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="3-local-setup.html"><a href="3-local-setup.html#servers-1"><i class="fa fa-check"></i><b>3.4</b> Servers</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="3-local-setup.html"><a href="3-local-setup.html#secure-shell-ssh"><i class="fa fa-check"></i><b>3.4.1</b> Secure Shell (SSH)</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3-local-setup.html"><a href="3-local-setup.html#readability-on-the-command-line"><i class="fa fa-check"></i><b>3.5</b> Readability on the Command Line</a></li>
<li class="chapter" data-level="3.6" data-path="3-local-setup.html"><a href="3-local-setup.html#summary-2"><i class="fa fa-check"></i><b>3.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-examples.html"><a href="4-examples.html"><i class="fa fa-check"></i><b>4</b> Examples</a>
<ul>
<li class="chapter" data-level="4.1" data-path="4-examples.html"><a href="4-examples.html#old-faithful"><i class="fa fa-check"></i><b>4.1</b> Old Faithful</a></li>
<li class="chapter" data-level="4.2" data-path="4-examples.html"><a href="4-examples.html#bananas"><i class="fa fa-check"></i><b>4.2</b> Bananas</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="4-examples.html"><a href="4-examples.html#the-bananas-data-set"><i class="fa fa-check"></i><b>4.2.1</b> The Bananas Data Set</a></li>
<li class="chapter" data-level="4.2.2" data-path="4-examples.html"><a href="4-examples.html#model-training"><i class="fa fa-check"></i><b>4.2.2</b> Model Training</a></li>
<li class="chapter" data-level="4.2.3" data-path="4-examples.html"><a href="4-examples.html#the-shiny-app"><i class="fa fa-check"></i><b>4.2.3</b> The Shiny App</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="4-examples.html"><a href="4-examples.html#load-balancing-test"><i class="fa fa-check"></i><b>4.3</b> Load Balancing Test</a></li>
<li class="chapter" data-level="4.4" data-path="4-examples.html"><a href="4-examples.html#summary-3"><i class="fa fa-check"></i><b>4.4</b> Summary</a></li>
</ul></li>
<li class="part"><span><b>II Shiny Apps</b></span></li>
<li class="chapter" data-level="5" data-path="5-developing-shiny-apps.html"><a href="5-developing-shiny-apps.html"><i class="fa fa-check"></i><b>5</b> Developing Shiny Apps</a>
<ul>
<li class="chapter" data-level="5.1" data-path="5-developing-shiny-apps.html"><a href="5-developing-shiny-apps.html#creating-a-shiny-app"><i class="fa fa-check"></i><b>5.1</b> Creating a Shiny App</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="5-developing-shiny-apps.html"><a href="5-developing-shiny-apps.html#the-user-interface"><i class="fa fa-check"></i><b>5.1.1</b> The User Interface</a></li>
<li class="chapter" data-level="5.1.2" data-path="5-developing-shiny-apps.html"><a href="5-developing-shiny-apps.html#the-server-function"><i class="fa fa-check"></i><b>5.1.2</b> The Server Function</a></li>
<li class="chapter" data-level="5.1.3" data-path="5-developing-shiny-apps.html"><a href="5-developing-shiny-apps.html#shiny-express"><i class="fa fa-check"></i><b>5.1.3</b> Shiny Express</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5-developing-shiny-apps.html"><a href="5-developing-shiny-apps.html#organizing-shiny-apps"><i class="fa fa-check"></i><b>5.2</b> Organizing Shiny Apps</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="5-developing-shiny-apps.html"><a href="5-developing-shiny-apps.html#single-file"><i class="fa fa-check"></i><b>5.2.1</b> Single file</a></li>
<li class="chapter" data-level="5.2.2" data-path="5-developing-shiny-apps.html"><a href="5-developing-shiny-apps.html#multiple-files"><i class="fa fa-check"></i><b>5.2.2</b> Multiple Files</a></li>
<li class="chapter" data-level="5.2.3" data-path="5-developing-shiny-apps.html"><a href="5-developing-shiny-apps.html#shiny-app-with-nested-files-structure"><i class="fa fa-check"></i><b>5.2.3</b> Shiny App with Nested Files Structure</a></li>
<li class="chapter" data-level="5.2.4" data-path="5-developing-shiny-apps.html"><a href="5-developing-shiny-apps.html#programmatic-cases"><i class="fa fa-check"></i><b>5.2.4</b> Programmatic Cases</a></li>
<li class="chapter" data-level="5.2.5" data-path="5-developing-shiny-apps.html"><a href="5-developing-shiny-apps.html#shiny-app-as-an-r-package"><i class="fa fa-check"></i><b>5.2.5</b> Shiny App as an R Package</a></li>
<li class="chapter" data-level="5.2.6" data-path="5-developing-shiny-apps.html"><a href="5-developing-shiny-apps.html#dynamic-documents"><i class="fa fa-check"></i><b>5.2.6</b> Dynamic Documents</a></li>
<li class="chapter" data-level="5.2.7" data-path="5-developing-shiny-apps.html"><a href="5-developing-shiny-apps.html#shinylive"><i class="fa fa-check"></i><b>5.2.7</b> Shinylive</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5-developing-shiny-apps.html"><a href="5-developing-shiny-apps.html#running-shiny-apps-locally"><i class="fa fa-check"></i><b>5.3</b> Running Shiny Apps Locally</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="5-developing-shiny-apps.html"><a href="5-developing-shiny-apps.html#r-1"><i class="fa fa-check"></i><b>5.3.1</b> R</a></li>
<li class="chapter" data-level="5.3.2" data-path="5-developing-shiny-apps.html"><a href="5-developing-shiny-apps.html#python"><i class="fa fa-check"></i><b>5.3.2</b> Python</a></li>
<li class="chapter" data-level="5.3.3" data-path="5-developing-shiny-apps.html"><a href="5-developing-shiny-apps.html#the-shiny-app-lifecycle"><i class="fa fa-check"></i><b>5.3.3</b> The Shiny App Lifecycle</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="5-developing-shiny-apps.html"><a href="5-developing-shiny-apps.html#sharing-the-shiny-app-code"><i class="fa fa-check"></i><b>5.4</b> Sharing the Shiny App Code</a></li>
<li class="chapter" data-level="5.5" data-path="5-developing-shiny-apps.html"><a href="5-developing-shiny-apps.html#summary-4"><i class="fa fa-check"></i><b>5.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html"><i class="fa fa-check"></i><b>6</b> Containerizing Shiny Apps</a>
<ul>
<li class="chapter" data-level="6.1" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#docker-concepts"><i class="fa fa-check"></i><b>6.1</b> Docker Concepts</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#docker-engine"><i class="fa fa-check"></i><b>6.1.1</b> Docker Engine</a></li>
<li class="chapter" data-level="6.1.2" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#container-registries"><i class="fa fa-check"></i><b>6.1.2</b> Container Registries</a></li>
<li class="chapter" data-level="6.1.3" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#images"><i class="fa fa-check"></i><b>6.1.3</b> Images</a></li>
<li class="chapter" data-level="6.1.4" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#the-dockerfile"><i class="fa fa-check"></i><b>6.1.4</b> The Dockerfile</a></li>
<li class="chapter" data-level="6.1.5" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#containers"><i class="fa fa-check"></i><b>6.1.5</b> Containers</a></li>
<li class="chapter" data-level="6.1.6" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#the-docker-command-line"><i class="fa fa-check"></i><b>6.1.6</b> The Docker Command Line</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#working-with-existing-images"><i class="fa fa-check"></i><b>6.2</b> Working with Existing Images</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#image-names-and-tags"><i class="fa fa-check"></i><b>6.2.1</b> Image Names and Tags</a></li>
<li class="chapter" data-level="6.2.2" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#pulling-an-image"><i class="fa fa-check"></i><b>6.2.2</b> Pulling an Image</a></li>
<li class="chapter" data-level="6.2.3" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#docker-login"><i class="fa fa-check"></i><b>6.2.3</b> Docker Login</a></li>
<li class="chapter" data-level="6.2.4" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#running-a-container"><i class="fa fa-check"></i><b>6.2.4</b> Running a Container</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#building-a-new-image"><i class="fa fa-check"></i><b>6.3</b> Building a New Image</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#r-for-shiny"><i class="fa fa-check"></i><b>6.3.1</b> R for Shiny</a></li>
<li class="chapter" data-level="6.3.2" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#buildx-and-buildkit"><i class="fa fa-check"></i><b>6.3.2</b> Buildx and BuildKit</a></li>
<li class="chapter" data-level="6.3.3" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#inspecting-the-image"><i class="fa fa-check"></i><b>6.3.3</b> Inspecting the Image</a></li>
<li class="chapter" data-level="6.3.4" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#r-for-python"><i class="fa fa-check"></i><b>6.3.4</b> R for Python</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#managing-images-and-containers"><i class="fa fa-check"></i><b>6.4</b> Managing Images and Containers</a></li>
<li class="chapter" data-level="6.5" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#sharing-images"><i class="fa fa-check"></i><b>6.5</b> Sharing Images</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#pushing-images"><i class="fa fa-check"></i><b>6.5.1</b> Pushing Images</a></li>
<li class="chapter" data-level="6.5.2" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#docker-registries"><i class="fa fa-check"></i><b>6.5.2</b> Docker Registries</a></li>
<li class="chapter" data-level="6.5.3" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#log-in-to-a-registry"><i class="fa fa-check"></i><b>6.5.3</b> Log In to a Registry</a></li>
<li class="chapter" data-level="6.5.4" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#local-registry"><i class="fa fa-check"></i><b>6.5.4</b> Local Registry</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#the-dockerfile-1"><i class="fa fa-check"></i><b>6.6</b> The Dockerfile</a></li>
<li class="chapter" data-level="6.7" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#shiny-apps-with-dependencies-use-bananas"><i class="fa fa-check"></i><b>6.7</b> Shiny Apps With Dependencies (use bananas)</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#parent-images"><i class="fa fa-check"></i><b>6.7.1</b> Parent Images</a></li>
<li class="chapter" data-level="6.7.2" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#system-libraries"><i class="fa fa-check"></i><b>6.7.2</b> system libraries</a></li>
<li class="chapter" data-level="6.7.3" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#r-dependencies"><i class="fa fa-check"></i><b>6.7.3</b> R dependencies</a></li>
<li class="chapter" data-level="6.7.4" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#python-requirements"><i class="fa fa-check"></i><b>6.7.4</b> Python requirements</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#best-practices"><i class="fa fa-check"></i><b>6.8</b> Best Practices</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#minimize-dependencies"><i class="fa fa-check"></i><b>6.8.1</b> Minimize dependencies</a></li>
<li class="chapter" data-level="6.8.2" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#use-caching"><i class="fa fa-check"></i><b>6.8.2</b> Use caching</a></li>
<li class="chapter" data-level="6.8.3" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#order-layers"><i class="fa fa-check"></i><b>6.8.3</b> Order layers</a></li>
<li class="chapter" data-level="6.8.4" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#switch-user"><i class="fa fa-check"></i><b>6.8.4</b> Switch user</a></li>
<li class="chapter" data-level="6.8.5" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#multi-stage-builds"><i class="fa fa-check"></i><b>6.8.5</b> Multi-stage Builds</a></li>
<li class="chapter" data-level="6.8.6" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#other-considerations"><i class="fa fa-check"></i><b>6.8.6</b> Other considerations</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#what-else"><i class="fa fa-check"></i><b>6.9</b> WHAT ELSE</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#layers-and-caching"><i class="fa fa-check"></i><b>6.9.1</b> Layers and Caching</a></li>
<li class="chapter" data-level="6.9.2" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#hardware-architectures"><i class="fa fa-check"></i><b>6.9.2</b> Hardware Architectures</a></li>
<li class="chapter" data-level="6.9.3" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#multi-stage-builds-1"><i class="fa fa-check"></i><b>6.9.3</b> Multi-stage builds</a></li>
<li class="chapter" data-level="6.9.4" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#mounting-volumes"><i class="fa fa-check"></i><b>6.9.4</b> Mounting volumes</a></li>
<li class="chapter" data-level="6.9.5" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#ports"><i class="fa fa-check"></i><b>6.9.5</b> Ports</a></li>
<li class="chapter" data-level="6.9.6" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#uid"><i class="fa fa-check"></i><b>6.9.6</b> UID</a></li>
<li class="chapter" data-level="6.9.7" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#troubleshooting"><i class="fa fa-check"></i><b>6.9.7</b> Troubleshooting</a></li>
<li class="chapter" data-level="6.9.8" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#shinylive-1"><i class="fa fa-check"></i><b>6.9.8</b> Shinylive</a></li>
<li class="chapter" data-level="6.9.9" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#rmd"><i class="fa fa-check"></i><b>6.9.9</b> Rmd</a></li>
<li class="chapter" data-level="6.9.10" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#quarto-1"><i class="fa fa-check"></i><b>6.9.10</b> Quarto</a></li>
<li class="chapter" data-level="6.9.11" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#using-buildkit"><i class="fa fa-check"></i><b>6.9.11</b> Using BuildKit</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#container-orchestration"><i class="fa fa-check"></i><b>6.10</b> Container Orchestration</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#docker-compose"><i class="fa fa-check"></i><b>6.10.1</b> Docker Compose</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#troubleshooting-1"><i class="fa fa-check"></i><b>6.11</b> Troubleshooting</a></li>
<li class="chapter" data-level="6.12" data-path="6-containerizing-shiny-apps.html"><a href="6-containerizing-shiny-apps.html#summary-5"><i class="fa fa-check"></i><b>6.12</b> Summary</a></li>
</ul></li>
<li class="part"><span><b>III Hosting Shiny Apps</b></span></li>
<li class="chapter" data-level="7" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html"><i class="fa fa-check"></i><b>7</b> A Review of Shiny Hosting Options</a>
<ul>
<li class="chapter" data-level="7.1" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#start-with-the-why"><i class="fa fa-check"></i><b>7.1</b> Start with the why</a></li>
<li class="chapter" data-level="7.2" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#list-your-requirements"><i class="fa fa-check"></i><b>7.2</b> List your requirements</a></li>
<li class="chapter" data-level="7.3" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#identify-your-constraints"><i class="fa fa-check"></i><b>7.3</b> Identify your constraints</a></li>
<li class="chapter" data-level="7.4" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#options-at-a-glance"><i class="fa fa-check"></i><b>7.4</b> Options at a glance</a></li>
<li class="chapter" data-level="7.5" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#hosting-patterns"><i class="fa fa-check"></i><b>7.5</b> Hosting Patterns</a></li>
<li class="chapter" data-level="7.6" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#the-cloud"><i class="fa fa-check"></i><b>7.6</b> The Cloud</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#servers-2"><i class="fa fa-check"></i><b>7.6.1</b> Servers</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#custom-domain-names"><i class="fa fa-check"></i><b>7.7</b> Custom Domain Names</a></li>
<li class="chapter" data-level="7.8" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#reverse-proxies"><i class="fa fa-check"></i><b>7.8</b> Reverse Proxies</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#install-caddy"><i class="fa fa-check"></i><b>7.8.1</b> Install Caddy</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#monitoring-processes"><i class="fa fa-check"></i><b>7.9</b> Monitoring Processes</a></li>
<li class="chapter" data-level="7.10" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#systemctl"><i class="fa fa-check"></i><b>7.10</b> Systemctl</a></li>
<li class="chapter" data-level="7.11" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#shutdown-and-reboot"><i class="fa fa-check"></i><b>7.11</b> Shutdown and Reboot</a></li>
<li class="chapter" data-level="7.12" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#networkingfirewalls"><i class="fa fa-check"></i><b>7.12</b> Networking/Firewalls</a>
<ul>
<li class="chapter" data-level="7.12.1" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#systemd"><i class="fa fa-check"></i><b>7.12.1</b> systemd</a></li>
</ul></li>
<li class="chapter" data-level="7.13" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#static-shiny-apps"><i class="fa fa-check"></i><b>7.13</b> Static Shiny Apps</a>
<ul>
<li class="chapter" data-level="7.13.1" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#compiling-without-containers-r-vs-python"><i class="fa fa-check"></i><b>7.13.1</b> Compiling without containers (R vs Python)</a></li>
<li class="chapter" data-level="7.13.2" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#compiling-with-containers"><i class="fa fa-check"></i><b>7.13.2</b> Compiling with containers</a></li>
<li class="chapter" data-level="7.13.3" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#static-hosting-options"><i class="fa fa-check"></i><b>7.13.3</b> Static Hosting Options</a></li>
</ul></li>
<li class="chapter" data-level="7.14" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#dynamic-shiny-apps"><i class="fa fa-check"></i><b>7.14</b> Dynamic Shiny Apps</a>
<ul>
<li class="chapter" data-level="7.14.1" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#hosting-platforms-paas"><i class="fa fa-check"></i><b>7.14.1</b> Hosting platforms (PaaS)</a></li>
<li class="chapter" data-level="7.14.2" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#reverse-proxy-required"><i class="fa fa-check"></i><b>7.14.2</b> Reverse Proxy Required</a></li>
</ul></li>
<li class="chapter" data-level="7.15" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#deploying-static-files-with-shinylive"><i class="fa fa-check"></i><b>7.15</b> Deploying Static Files with Shinylive</a></li>
<li class="chapter" data-level="7.16" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#deploying-shiny-apps-to-shinyapps.io"><i class="fa fa-check"></i><b>7.16</b> Deploying Shiny Apps to Shinyapps.io</a>
<ul>
<li class="chapter" data-level="7.16.1" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#r-2"><i class="fa fa-check"></i><b>7.16.1</b> R</a></li>
<li class="chapter" data-level="7.16.2" data-path="7-a-review-of-shiny-hosting-options.html"><a href="7-a-review-of-shiny-hosting-options.html#python-1"><i class="fa fa-check"></i><b>7.16.2</b> Python</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-considerations-hosting.html"><a href="8-considerations-hosting.html"><i class="fa fa-check"></i><b>8</b> Considerations for Hosting Production Shiny Apps</a>
<ul>
<li class="chapter" data-level="8.1" data-path="8-considerations-hosting.html"><a href="8-considerations-hosting.html#security"><i class="fa fa-check"></i><b>8.1</b> Security</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="8-considerations-hosting.html"><a href="8-considerations-hosting.html#certificates"><i class="fa fa-check"></i><b>8.1.1</b> Certificates</a></li>
<li class="chapter" data-level="8.1.2" data-path="8-considerations-hosting.html"><a href="8-considerations-hosting.html#storing-secrets"><i class="fa fa-check"></i><b>8.1.2</b> Storing Secrets</a></li>
<li class="chapter" data-level="8.1.3" data-path="8-considerations-hosting.html"><a href="8-considerations-hosting.html#shiny-app-authentication"><i class="fa fa-check"></i><b>8.1.3</b> Shiny App Authentication</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="8-considerations-hosting.html"><a href="8-considerations-hosting.html#performance-availability-and-monitoring"><i class="fa fa-check"></i><b>8.2</b> Performance, Availability, and Monitoring</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="8-considerations-hosting.html"><a href="8-considerations-hosting.html#scaling"><i class="fa fa-check"></i><b>8.2.1</b> Scaling</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="8-considerations-hosting.html"><a href="8-considerations-hosting.html#operations-and-maintenance"><i class="fa fa-check"></i><b>8.3</b> Operations and Maintenance</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="8-considerations-hosting.html"><a href="8-considerations-hosting.html#cicd"><i class="fa fa-check"></i><b>8.3.1</b> CI/CD</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="8-considerations-hosting.html"><a href="8-considerations-hosting.html#embedding-onto-your-website"><i class="fa fa-check"></i><b>8.4</b> Embedding Onto Your Website</a></li>
<li class="chapter" data-level="8.5" data-path="8-considerations-hosting.html"><a href="8-considerations-hosting.html#other-stuff"><i class="fa fa-check"></i><b>8.5</b> OTHER STUFF</a></li>
</ul></li>
<li class="part"><span><b>IV What Is Next?</b></span></li>
<li class="chapter" data-level="9" data-path="9-information-about-hosting.html"><a href="9-information-about-hosting.html"><i class="fa fa-check"></i><b>9</b> Information about hosting</a></li>
<li class="chapter" data-level="10" data-path="10-conclusions.html"><a href="10-conclusions.html"><i class="fa fa-check"></i><b>10</b> Conclusions</a></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="" data-path="appendix-bananas.html"><a href="appendix-bananas.html"><i class="fa fa-check"></i>The Bananas Data Set</a></li>
<li class="chapter" data-level="" data-path="appendix-lb-app.html"><a href="appendix-lb-app.html"><i class="fa fa-check"></i>Shiny App for Testing Load Balancing</a>
<ul>
<li class="chapter" data-level="" data-path="appendix-lb-app.html"><a href="appendix-lb-app.html#the-python-version"><i class="fa fa-check"></i>The Python Version</a></li>
<li class="chapter" data-level="" data-path="appendix-lb-app.html"><a href="appendix-lb-app.html#the-r-version"><i class="fa fa-check"></i>The R Version</a></li>
<li class="chapter" data-level="" data-path="appendix-lb-app.html"><a href="appendix-lb-app.html#shinylive-2"><i class="fa fa-check"></i>Shinylive</a></li>
<li class="chapter" data-level="" data-path="appendix-lb-app.html"><a href="appendix-lb-app.html#test-load-balancing"><i class="fa fa-check"></i>Test Load Balancing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-how-to-pick.html"><a href="appendix-how-to-pick.html"><i class="fa fa-check"></i>How to Pick the Right Hosting Option</a>
<ul>
<li class="chapter" data-level="" data-path="appendix-how-to-pick.html"><a href="appendix-how-to-pick.html#start-with-the-why-1"><i class="fa fa-check"></i>Start with the Why</a></li>
<li class="chapter" data-level="" data-path="appendix-how-to-pick.html"><a href="appendix-how-to-pick.html#list-your-requirements-1"><i class="fa fa-check"></i>List Your Requirements</a></li>
<li class="chapter" data-level="" data-path="appendix-how-to-pick.html"><a href="appendix-how-to-pick.html#identify-your-constraints-1"><i class="fa fa-check"></i>Identify Your Constraints</a></li>
<li class="chapter" data-level="" data-path="appendix-how-to-pick.html"><a href="appendix-how-to-pick.html#options-at-a-glance-1"><i class="fa fa-check"></i>Options at a glance</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-setup.html"><a href="appendix-setup.html"><i class="fa fa-check"></i>Setting Up Your Development Environment</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Hosting Shiny Applications for R and Python</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<html>
<img width='200px' src='https://hosting.analythium.io/content/images/size/w600/2021/03/banner-1.png' alt="Hosting Shiny">
</html>
<div id="developing-shiny-apps" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Developing Shiny Apps<a href="5-developing-shiny-apps.html#developing-shiny-apps" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Shiny apps can be written in two languages, R and Python. These 2 programming
languages are commonly used for data analysis.
R is an interpreted computer language for statistical computing and graphics.
Likewise, Python is an interpreted general programming language that is often
used for data science. Both R and Python run on a wide variety of operating
systems including Windows, MacOS, and Linux.</p>
<p>In this first chapter, we will cover getting started with developing in Shiny
using R and Python environments. We discuss the tools commonly used for these
programming languages and provide instructions on how to run our example Shiny
application projects in an integrated development environment (IDE). Then we’ll
review some of the easiest ways of sharing and deploying Shiny apps.</p>
<div id="creating-a-shiny-app" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Creating a Shiny App<a href="5-developing-shiny-apps.html#creating-a-shiny-app" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A Shiny app is made up of the user interface (UI) and the
server function. The UI and the server can be written in pure R or Python,
but it can also incorporate JavaScript, CSS, or HTML code.</p>
<p>The app is served to the client (app user) through a host (Internet
Protocol or IP address) and port number. The server then keeps a
websocket connection open to receive requests. The Shiny session behind the app
will make sure this request translates into the desired interactivity and sends
back the response, usually an updated object, like a plot or a table
(Fig. <a href="5-developing-shiny-apps.html#fig:part2-shiny-app-architecture">5.1</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:part2-shiny-app-architecture"></span>
<img src="images/02/shiny-app-architecture.png" alt="Simplified Shiny app architecture." width="\textwidth" />
<p class="caption">
Figure 5.1: Simplified Shiny app architecture.
</p>
</div>
<p>The Old Faithful (<code>faithful</code>) app is a relatively simple example that is concise enough to
demonstrate the structure of Shiny apps with the basics of reactivity.
It draws a histogram based on the Old Faithful geyser waiting times.
The number of bins in the histogram can be changed by the user with a slider.</p>
<p>The source code for the different builds of the Old Faithful Shiny app is at
<a href="https://github.com/h10y/faithful" class="uri">https://github.com/h10y/faithful</a>. You can download the GitHub repository
az a zip file from GitHub, or clone the repository with
<code>git clone https://github.com/h10y/faithful.git</code>.</p>
<p>To run this app in R, create a folder called <code>r-shiny</code> with a new file called
<code>app.R</code> inside the folder. Put this inside the file:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="5-developing-shiny-apps.html#cb6-1" tabindex="-1"></a><span class="co"># r-shiny/app.R</span></span>
<span id="cb6-2"><a href="5-developing-shiny-apps.html#cb6-2" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb6-3"><a href="5-developing-shiny-apps.html#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="5-developing-shiny-apps.html#cb6-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> faithful<span class="sc">$</span>waiting</span>
<span id="cb6-5"><a href="5-developing-shiny-apps.html#cb6-5" tabindex="-1"></a></span>
<span id="cb6-6"><a href="5-developing-shiny-apps.html#cb6-6" tabindex="-1"></a>app_ui <span class="ot">&lt;-</span> <span class="fu">fixedPage</span>(</span>
<span id="cb6-7"><a href="5-developing-shiny-apps.html#cb6-7" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Old Faithful&quot;</span>,</span>
<span id="cb6-8"><a href="5-developing-shiny-apps.html#cb6-8" tabindex="-1"></a>  <span class="fu">h2</span>(<span class="st">&quot;Old Faithful&quot;</span>),</span>
<span id="cb6-9"><a href="5-developing-shiny-apps.html#cb6-9" tabindex="-1"></a>  <span class="fu">plotOutput</span>(<span class="at">outputId =</span> <span class="st">&quot;histogram&quot;</span>),</span>
<span id="cb6-10"><a href="5-developing-shiny-apps.html#cb6-10" tabindex="-1"></a>  <span class="fu">sliderInput</span>(</span>
<span id="cb6-11"><a href="5-developing-shiny-apps.html#cb6-11" tabindex="-1"></a>    <span class="at">inputId =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb6-12"><a href="5-developing-shiny-apps.html#cb6-12" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">&quot;Number of bins:&quot;</span>,</span>
<span id="cb6-13"><a href="5-developing-shiny-apps.html#cb6-13" tabindex="-1"></a>    <span class="at">min =</span> <span class="dv">1</span>,</span>
<span id="cb6-14"><a href="5-developing-shiny-apps.html#cb6-14" tabindex="-1"></a>    <span class="at">max =</span> <span class="dv">50</span>,</span>
<span id="cb6-15"><a href="5-developing-shiny-apps.html#cb6-15" tabindex="-1"></a>    <span class="at">value =</span> <span class="dv">25</span>,</span>
<span id="cb6-16"><a href="5-developing-shiny-apps.html#cb6-16" tabindex="-1"></a>    <span class="at">ticks =</span> <span class="cn">TRUE</span></span>
<span id="cb6-17"><a href="5-developing-shiny-apps.html#cb6-17" tabindex="-1"></a>  )</span>
<span id="cb6-18"><a href="5-developing-shiny-apps.html#cb6-18" tabindex="-1"></a>)</span>
<span id="cb6-19"><a href="5-developing-shiny-apps.html#cb6-19" tabindex="-1"></a></span>
<span id="cb6-20"><a href="5-developing-shiny-apps.html#cb6-20" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb6-21"><a href="5-developing-shiny-apps.html#cb6-21" tabindex="-1"></a>  output<span class="sc">$</span>histogram <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>(</span>
<span id="cb6-22"><a href="5-developing-shiny-apps.html#cb6-22" tabindex="-1"></a>    <span class="at">alt =</span> <span class="st">&quot;Histogram of waiting times&quot;</span>,</span>
<span id="cb6-23"><a href="5-developing-shiny-apps.html#cb6-23" tabindex="-1"></a>    {</span>
<span id="cb6-24"><a href="5-developing-shiny-apps.html#cb6-24" tabindex="-1"></a>      <span class="fu">hist</span>(</span>
<span id="cb6-25"><a href="5-developing-shiny-apps.html#cb6-25" tabindex="-1"></a>        x,</span>
<span id="cb6-26"><a href="5-developing-shiny-apps.html#cb6-26" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">min</span>(x), <span class="fu">max</span>(x),</span>
<span id="cb6-27"><a href="5-developing-shiny-apps.html#cb6-27" tabindex="-1"></a>          <span class="at">length.out =</span> input<span class="sc">$</span>n <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-28"><a href="5-developing-shiny-apps.html#cb6-28" tabindex="-1"></a>        ),</span>
<span id="cb6-29"><a href="5-developing-shiny-apps.html#cb6-29" tabindex="-1"></a>        <span class="at">freq =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-30"><a href="5-developing-shiny-apps.html#cb6-30" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;#BB74DB&quot;</span>,</span>
<span id="cb6-31"><a href="5-developing-shiny-apps.html#cb6-31" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb6-32"><a href="5-developing-shiny-apps.html#cb6-32" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Histogram of waiting times&quot;</span>,</span>
<span id="cb6-33"><a href="5-developing-shiny-apps.html#cb6-33" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Waiting time to next eruption [mins]&quot;</span>,</span>
<span id="cb6-34"><a href="5-developing-shiny-apps.html#cb6-34" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Frequency&quot;</span></span>
<span id="cb6-35"><a href="5-developing-shiny-apps.html#cb6-35" tabindex="-1"></a>      )</span>
<span id="cb6-36"><a href="5-developing-shiny-apps.html#cb6-36" tabindex="-1"></a>      <span class="fu">box</span>()</span>
<span id="cb6-37"><a href="5-developing-shiny-apps.html#cb6-37" tabindex="-1"></a>    }</span>
<span id="cb6-38"><a href="5-developing-shiny-apps.html#cb6-38" tabindex="-1"></a>  )</span>
<span id="cb6-39"><a href="5-developing-shiny-apps.html#cb6-39" tabindex="-1"></a>}</span>
<span id="cb6-40"><a href="5-developing-shiny-apps.html#cb6-40" tabindex="-1"></a></span>
<span id="cb6-41"><a href="5-developing-shiny-apps.html#cb6-41" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> app_ui, <span class="at">server =</span> server)</span></code></pre></div>
<p>For the Python version, create a new file called <code>app.py</code> inside the <code>py-shiny</code>
folder and put this inside the file:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="5-developing-shiny-apps.html#cb7-1" tabindex="-1"></a><span class="co"># py-shiny/app.py</span></span>
<span id="cb7-2"><a href="5-developing-shiny-apps.html#cb7-2" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb7-3"><a href="5-developing-shiny-apps.html#cb7-3" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb7-4"><a href="5-developing-shiny-apps.html#cb7-4" tabindex="-1"></a><span class="im">from</span> shiny <span class="im">import</span> App, render, ui</span>
<span id="cb7-5"><a href="5-developing-shiny-apps.html#cb7-5" tabindex="-1"></a></span>
<span id="cb7-6"><a href="5-developing-shiny-apps.html#cb7-6" tabindex="-1"></a>faithful <span class="op">=</span> sns.load_dataset(<span class="st">&quot;geyser&quot;</span>)</span>
<span id="cb7-7"><a href="5-developing-shiny-apps.html#cb7-7" tabindex="-1"></a>x <span class="op">=</span> faithful.waiting</span>
<span id="cb7-8"><a href="5-developing-shiny-apps.html#cb7-8" tabindex="-1"></a></span>
<span id="cb7-9"><a href="5-developing-shiny-apps.html#cb7-9" tabindex="-1"></a>app_ui <span class="op">=</span> ui.page_fixed(</span>
<span id="cb7-10"><a href="5-developing-shiny-apps.html#cb7-10" tabindex="-1"></a>    ui.panel_title(<span class="st">&quot;Old Faithful&quot;</span>),</span>
<span id="cb7-11"><a href="5-developing-shiny-apps.html#cb7-11" tabindex="-1"></a>    ui.output_plot(<span class="bu">id</span> <span class="op">=</span> <span class="st">&quot;histogram&quot;</span>),</span>
<span id="cb7-12"><a href="5-developing-shiny-apps.html#cb7-12" tabindex="-1"></a>    ui.input_slider(</span>
<span id="cb7-13"><a href="5-developing-shiny-apps.html#cb7-13" tabindex="-1"></a>            <span class="bu">id</span><span class="op">=</span><span class="st">&quot;n&quot;</span>, </span>
<span id="cb7-14"><a href="5-developing-shiny-apps.html#cb7-14" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&quot;Number of bins:&quot;</span>, </span>
<span id="cb7-15"><a href="5-developing-shiny-apps.html#cb7-15" tabindex="-1"></a>            <span class="bu">min</span><span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb7-16"><a href="5-developing-shiny-apps.html#cb7-16" tabindex="-1"></a>            <span class="bu">max</span><span class="op">=</span><span class="dv">50</span>, </span>
<span id="cb7-17"><a href="5-developing-shiny-apps.html#cb7-17" tabindex="-1"></a>            value<span class="op">=</span><span class="dv">25</span>,</span>
<span id="cb7-18"><a href="5-developing-shiny-apps.html#cb7-18" tabindex="-1"></a>            ticks<span class="op">=</span><span class="va">True</span></span>
<span id="cb7-19"><a href="5-developing-shiny-apps.html#cb7-19" tabindex="-1"></a>    ),</span>
<span id="cb7-20"><a href="5-developing-shiny-apps.html#cb7-20" tabindex="-1"></a>)</span>
<span id="cb7-21"><a href="5-developing-shiny-apps.html#cb7-21" tabindex="-1"></a></span>
<span id="cb7-22"><a href="5-developing-shiny-apps.html#cb7-22" tabindex="-1"></a><span class="kw">def</span> server(<span class="bu">input</span>, output, session):</span>
<span id="cb7-23"><a href="5-developing-shiny-apps.html#cb7-23" tabindex="-1"></a>    <span class="at">@output</span></span>
<span id="cb7-24"><a href="5-developing-shiny-apps.html#cb7-24" tabindex="-1"></a>    <span class="at">@render.plot</span>(alt<span class="op">=</span><span class="st">&quot;Histogram of waiting times&quot;</span>)</span>
<span id="cb7-25"><a href="5-developing-shiny-apps.html#cb7-25" tabindex="-1"></a>    <span class="kw">def</span> histogram():</span>
<span id="cb7-26"><a href="5-developing-shiny-apps.html#cb7-26" tabindex="-1"></a>        plt.hist(</span>
<span id="cb7-27"><a href="5-developing-shiny-apps.html#cb7-27" tabindex="-1"></a>            x, </span>
<span id="cb7-28"><a href="5-developing-shiny-apps.html#cb7-28" tabindex="-1"></a>            bins <span class="op">=</span> <span class="bu">input</span>.n(), </span>
<span id="cb7-29"><a href="5-developing-shiny-apps.html#cb7-29" tabindex="-1"></a>            density<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb7-30"><a href="5-developing-shiny-apps.html#cb7-30" tabindex="-1"></a>            color<span class="op">=</span><span class="st">&quot;#BB74DB&quot;</span>,</span>
<span id="cb7-31"><a href="5-developing-shiny-apps.html#cb7-31" tabindex="-1"></a>            edgecolor<span class="op">=</span><span class="st">&quot;white&quot;</span>)</span>
<span id="cb7-32"><a href="5-developing-shiny-apps.html#cb7-32" tabindex="-1"></a>        plt.title(<span class="st">&quot;Histogram of waiting times&quot;</span>)</span>
<span id="cb7-33"><a href="5-developing-shiny-apps.html#cb7-33" tabindex="-1"></a>        plt.xlabel(<span class="st">&quot;Waiting time to next eruption [mins]&quot;</span>)</span>
<span id="cb7-34"><a href="5-developing-shiny-apps.html#cb7-34" tabindex="-1"></a>        plt.ylabel(<span class="st">&quot;Frequency&quot;</span>)</span>
<span id="cb7-35"><a href="5-developing-shiny-apps.html#cb7-35" tabindex="-1"></a></span>
<span id="cb7-36"><a href="5-developing-shiny-apps.html#cb7-36" tabindex="-1"></a>app <span class="op">=</span> App(ui <span class="op">=</span> app_ui, server <span class="op">=</span> server)</span></code></pre></div>
<p>Besides Shiny, you’ll need to have the <code>seaborn</code> and <code>matplotlib</code> libraries
installed for the geyser data set and the histogram. R has these functions as
part of the base distribution, so no additional installation is needed.
Install Python dependencies from the <code>requirements.txt</code> file with
<code>pip install -r py-shiny/requirements.txt</code>. Here are the contents of
the <code>requirements.txt</code> file:</p>
<pre class="text"><code># py-shiny/requirements.txt
shiny&gt;=0.10.2
matplotlib
seaborn</code></pre>
<p>You have probably noticed the similarities between the R and Python versions.
Both started with loading/importing libraries and defining a globally available
that contained the Old Faithful geyser waiting times. The files then defined
the user interface (<code>app_ui</code>) and the <code>server</code> function. At the end,
we defined the Shiny app as <code>shinyApp(ui = app_ui, server = server)</code> and
<code>App(ui = app_ui, server = server)</code>.
Now let us explore the user interface and the server function.</p>
<div id="the-user-interface" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> The User Interface<a href="5-developing-shiny-apps.html#the-user-interface" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The user interface (UI) object controls the layout and appearance of the
Shiny app. The UI in R is defined as and object called <code>app_ui</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="5-developing-shiny-apps.html#cb9-1" tabindex="-1"></a>app_ui <span class="ot">&lt;-</span> <span class="fu">fixedPage</span>(</span>
<span id="cb9-2"><a href="5-developing-shiny-apps.html#cb9-2" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Old Faithful&quot;</span>,</span>
<span id="cb9-3"><a href="5-developing-shiny-apps.html#cb9-3" tabindex="-1"></a>  <span class="fu">h2</span>(<span class="st">&quot;Old Faithful&quot;</span>),</span>
<span id="cb9-4"><a href="5-developing-shiny-apps.html#cb9-4" tabindex="-1"></a>  <span class="fu">plotOutput</span>(<span class="at">outputId =</span> <span class="st">&quot;histogram&quot;</span>),</span>
<span id="cb9-5"><a href="5-developing-shiny-apps.html#cb9-5" tabindex="-1"></a>  <span class="fu">sliderInput</span>(</span>
<span id="cb9-6"><a href="5-developing-shiny-apps.html#cb9-6" tabindex="-1"></a>    <span class="at">inputId =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb9-7"><a href="5-developing-shiny-apps.html#cb9-7" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">&quot;Number of bins:&quot;</span>,</span>
<span id="cb9-8"><a href="5-developing-shiny-apps.html#cb9-8" tabindex="-1"></a>    <span class="at">min =</span> <span class="dv">1</span>,</span>
<span id="cb9-9"><a href="5-developing-shiny-apps.html#cb9-9" tabindex="-1"></a>    <span class="at">max =</span> <span class="dv">50</span>,</span>
<span id="cb9-10"><a href="5-developing-shiny-apps.html#cb9-10" tabindex="-1"></a>    <span class="at">value =</span> <span class="dv">25</span>,</span>
<span id="cb9-11"><a href="5-developing-shiny-apps.html#cb9-11" tabindex="-1"></a>    <span class="at">ticks =</span> <span class="cn">TRUE</span></span>
<span id="cb9-12"><a href="5-developing-shiny-apps.html#cb9-12" tabindex="-1"></a>  )</span>
<span id="cb9-13"><a href="5-developing-shiny-apps.html#cb9-13" tabindex="-1"></a>)</span></code></pre></div>
<p>The <code>fixedPage()</code> function renders the main Shiny interface, a
plot output is nested inside of it alongside the range slider input. The
slider with the ID <code>"n"</code> controls the number of bins in the histogram
(ranging between 1 and 50, initial value set to 25). The plot with ID
<code>"histogram"</code> will show the distribution of the waiting times.</p>
<p>If we print the <code>app_ui</code> object, we get the following (slightly edited) HTML
output where you can see how the attributes from the R code translate to
arguments in the HTML version:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb10-1"><a href="5-developing-shiny-apps.html#cb10-1" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;container&quot;</span><span class="dt">&gt;</span></span>
<span id="cb10-2"><a href="5-developing-shiny-apps.html#cb10-2" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">h2</span><span class="dt">&gt;</span></span>
<span id="cb10-3"><a href="5-developing-shiny-apps.html#cb10-3" tabindex="-1"></a>    Old Faithful</span>
<span id="cb10-4"><a href="5-developing-shiny-apps.html#cb10-4" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">h2</span><span class="dt">&gt;</span></span>
<span id="cb10-5"><a href="5-developing-shiny-apps.html#cb10-5" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;histogram&quot;</span><span class="dt">&gt;</span></span>
<span id="cb10-6"><a href="5-developing-shiny-apps.html#cb10-6" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb10-7"><a href="5-developing-shiny-apps.html#cb10-7" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;form-group shiny-input-container&quot;</span><span class="dt">&gt;</span></span>
<span id="cb10-8"><a href="5-developing-shiny-apps.html#cb10-8" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">label</span><span class="ot"> </span></span>
<span id="cb10-9"><a href="5-developing-shiny-apps.html#cb10-9" tabindex="-1"></a><span class="ot">      class</span><span class="op">=</span><span class="st">&quot;control-label&quot;</span><span class="ot"> </span></span>
<span id="cb10-10"><a href="5-developing-shiny-apps.html#cb10-10" tabindex="-1"></a><span class="ot">      id</span><span class="op">=</span><span class="st">&quot;n-label&quot;</span><span class="ot"> </span></span>
<span id="cb10-11"><a href="5-developing-shiny-apps.html#cb10-11" tabindex="-1"></a><span class="ot">      for</span><span class="op">=</span><span class="st">&quot;n&quot;</span><span class="dt">&gt;</span></span>
<span id="cb10-12"><a href="5-developing-shiny-apps.html#cb10-12" tabindex="-1"></a>      Number of bins:</span>
<span id="cb10-13"><a href="5-developing-shiny-apps.html#cb10-13" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb10-14"><a href="5-developing-shiny-apps.html#cb10-14" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> </span></span>
<span id="cb10-15"><a href="5-developing-shiny-apps.html#cb10-15" tabindex="-1"></a><span class="ot">      class</span><span class="op">=</span><span class="st">&quot;js-range-slider&quot;</span><span class="ot"> </span></span>
<span id="cb10-16"><a href="5-developing-shiny-apps.html#cb10-16" tabindex="-1"></a><span class="ot">      id</span><span class="op">=</span><span class="st">&quot;n&quot;</span><span class="ot"> </span></span>
<span id="cb10-17"><a href="5-developing-shiny-apps.html#cb10-17" tabindex="-1"></a><span class="ot">      data-min</span><span class="op">=</span><span class="st">&quot;1&quot;</span><span class="ot"> </span></span>
<span id="cb10-18"><a href="5-developing-shiny-apps.html#cb10-18" tabindex="-1"></a><span class="ot">      data-max</span><span class="op">=</span><span class="st">&quot;50&quot;</span><span class="ot"> </span></span>
<span id="cb10-19"><a href="5-developing-shiny-apps.html#cb10-19" tabindex="-1"></a><span class="ot">      data-from</span><span class="op">=</span><span class="st">&quot;25&quot;</span><span class="ot"> </span></span>
<span id="cb10-20"><a href="5-developing-shiny-apps.html#cb10-20" tabindex="-1"></a><span class="ot">      data-step</span><span class="op">=</span><span class="st">&quot;1&quot;</span><span class="ot"> </span></span>
<span id="cb10-21"><a href="5-developing-shiny-apps.html#cb10-21" tabindex="-1"></a><span class="ot">      data-grid</span><span class="op">=</span><span class="st">&quot;true&quot;</span><span class="dt">/&gt;</span></span>
<span id="cb10-22"><a href="5-developing-shiny-apps.html#cb10-22" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb10-23"><a href="5-developing-shiny-apps.html#cb10-23" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span></code></pre></div>
<p>You can see the container, and the plot and the slider nested inside.
This is going to be added to the body of the HTML page rendered by
Shiny. The final HTML page will also contain all the JavaScript and CSS
dependencies required to make the app interactive and styled properly.</p>
<p>The Python UI uses the <code>ui</code> object imported from <code>shiny</code>. The setup is very
similar to the R setup, but naming conventions are slightly different
(<code>fixedPage</code> vs. <code>page_fixed</code>, <code>plotOutput</code> vs. <code>output_plot</code> and
<code>sliderInput</code> vs. <code>input_slider</code>).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="5-developing-shiny-apps.html#cb11-1" tabindex="-1"></a>app_ui <span class="op">=</span> ui.page_fixed(</span>
<span id="cb11-2"><a href="5-developing-shiny-apps.html#cb11-2" tabindex="-1"></a>    ui.panel_title(<span class="st">&quot;Old Faithful&quot;</span>),</span>
<span id="cb11-3"><a href="5-developing-shiny-apps.html#cb11-3" tabindex="-1"></a>    ui.output_plot(<span class="bu">id</span> <span class="op">=</span> <span class="st">&quot;histogram&quot;</span>),</span>
<span id="cb11-4"><a href="5-developing-shiny-apps.html#cb11-4" tabindex="-1"></a>    ui.input_slider(</span>
<span id="cb11-5"><a href="5-developing-shiny-apps.html#cb11-5" tabindex="-1"></a>            <span class="bu">id</span><span class="op">=</span><span class="st">&quot;n&quot;</span>, </span>
<span id="cb11-6"><a href="5-developing-shiny-apps.html#cb11-6" tabindex="-1"></a>            label<span class="op">=</span><span class="st">&quot;Number of bins:&quot;</span>, </span>
<span id="cb11-7"><a href="5-developing-shiny-apps.html#cb11-7" tabindex="-1"></a>            <span class="bu">min</span><span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb11-8"><a href="5-developing-shiny-apps.html#cb11-8" tabindex="-1"></a>            <span class="bu">max</span><span class="op">=</span><span class="dv">50</span>, </span>
<span id="cb11-9"><a href="5-developing-shiny-apps.html#cb11-9" tabindex="-1"></a>            value<span class="op">=</span><span class="dv">25</span>,</span>
<span id="cb11-10"><a href="5-developing-shiny-apps.html#cb11-10" tabindex="-1"></a>            ticks<span class="op">=</span><span class="va">True</span></span>
<span id="cb11-11"><a href="5-developing-shiny-apps.html#cb11-11" tabindex="-1"></a>    ),</span>
<span id="cb11-12"><a href="5-developing-shiny-apps.html#cb11-12" tabindex="-1"></a>)</span></code></pre></div>
<p>Printing the <code>app_ui</code> in Python gives the following (slightly edited) HTML output:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb12-1"><a href="5-developing-shiny-apps.html#cb12-1" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="dt">&gt;</span></span>
<span id="cb12-2"><a href="5-developing-shiny-apps.html#cb12-2" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb12-3"><a href="5-developing-shiny-apps.html#cb12-3" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb12-4"><a href="5-developing-shiny-apps.html#cb12-4" tabindex="-1"></a>  <span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb12-5"><a href="5-developing-shiny-apps.html#cb12-5" tabindex="-1"></a>    <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;container&quot;</span><span class="dt">&gt;</span></span>
<span id="cb12-6"><a href="5-developing-shiny-apps.html#cb12-6" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">h2</span><span class="dt">&gt;</span></span>
<span id="cb12-7"><a href="5-developing-shiny-apps.html#cb12-7" tabindex="-1"></a>        Old Faithful</span>
<span id="cb12-8"><a href="5-developing-shiny-apps.html#cb12-8" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">h2</span><span class="dt">&gt;</span></span>
<span id="cb12-9"><a href="5-developing-shiny-apps.html#cb12-9" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;histogram&quot;</span><span class="dt">&gt;</span></span>
<span id="cb12-10"><a href="5-developing-shiny-apps.html#cb12-10" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb12-11"><a href="5-developing-shiny-apps.html#cb12-11" tabindex="-1"></a>      <span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;form-group shiny-input-container&quot;</span><span class="dt">&gt;</span></span>
<span id="cb12-12"><a href="5-developing-shiny-apps.html#cb12-12" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">label</span><span class="ot"> </span></span>
<span id="cb12-13"><a href="5-developing-shiny-apps.html#cb12-13" tabindex="-1"></a><span class="ot">          class</span><span class="op">=</span><span class="st">&quot;control-label&quot;</span><span class="ot"> </span></span>
<span id="cb12-14"><a href="5-developing-shiny-apps.html#cb12-14" tabindex="-1"></a><span class="ot">          id</span><span class="op">=</span><span class="st">&quot;n-label&quot;</span><span class="ot"> for</span><span class="op">=</span><span class="st">&quot;n&quot;</span><span class="dt">&gt;</span></span>
<span id="cb12-15"><a href="5-developing-shiny-apps.html#cb12-15" tabindex="-1"></a>          Number of bins:</span>
<span id="cb12-16"><a href="5-developing-shiny-apps.html#cb12-16" tabindex="-1"></a>        <span class="dt">&lt;/</span><span class="kw">label</span><span class="dt">&gt;</span></span>
<span id="cb12-17"><a href="5-developing-shiny-apps.html#cb12-17" tabindex="-1"></a>        <span class="dt">&lt;</span><span class="kw">input</span><span class="ot"> </span></span>
<span id="cb12-18"><a href="5-developing-shiny-apps.html#cb12-18" tabindex="-1"></a><span class="ot">          class</span><span class="op">=</span><span class="st">&quot;js-range-slider&quot;</span><span class="ot"> </span></span>
<span id="cb12-19"><a href="5-developing-shiny-apps.html#cb12-19" tabindex="-1"></a><span class="ot">          id</span><span class="op">=</span><span class="st">&quot;n&quot;</span><span class="ot"> </span></span>
<span id="cb12-20"><a href="5-developing-shiny-apps.html#cb12-20" tabindex="-1"></a><span class="ot">          data-min</span><span class="op">=</span><span class="st">&quot;1&quot;</span><span class="ot"> </span></span>
<span id="cb12-21"><a href="5-developing-shiny-apps.html#cb12-21" tabindex="-1"></a><span class="ot">          data-max</span><span class="op">=</span><span class="st">&quot;50&quot;</span><span class="ot"> </span></span>
<span id="cb12-22"><a href="5-developing-shiny-apps.html#cb12-22" tabindex="-1"></a><span class="ot">          data-from</span><span class="op">=</span><span class="st">&quot;25&quot;</span><span class="ot"> </span></span>
<span id="cb12-23"><a href="5-developing-shiny-apps.html#cb12-23" tabindex="-1"></a><span class="ot">          data-step</span><span class="op">=</span><span class="st">&quot;1&quot;</span><span class="ot"> </span></span>
<span id="cb12-24"><a href="5-developing-shiny-apps.html#cb12-24" tabindex="-1"></a><span class="ot">          data-grid</span><span class="op">=</span><span class="st">&quot;true&quot;</span><span class="dt">/&gt;</span></span>
<span id="cb12-25"><a href="5-developing-shiny-apps.html#cb12-25" tabindex="-1"></a>      <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb12-26"><a href="5-developing-shiny-apps.html#cb12-26" tabindex="-1"></a>    <span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb12-27"><a href="5-developing-shiny-apps.html#cb12-27" tabindex="-1"></a>  <span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb12-28"><a href="5-developing-shiny-apps.html#cb12-28" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code></pre></div>
<p>The only difference relative to the R output is that you can see the <code>&lt;html&gt;</code>,
<code>&lt;head&gt;</code> and <code>&lt;body&gt;</code> tags. Shiny will inject elements into the HTML head later.</p>
</div>
<div id="the-server-function" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> The Server Function<a href="5-developing-shiny-apps.html#the-server-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The server function contains the instructions for the reactivity needed
for the Shiny app. The server function takes two arguments: <code>input</code> and
<code>output</code> (sometimes also <code>session</code>). These reactive objects are created
by Shiny and passed to the server function.</p>
<p><code>input</code> is used to pass the control values, in this case, <code>input$n</code>,
the number of histogram bins:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="5-developing-shiny-apps.html#cb13-1" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb13-2"><a href="5-developing-shiny-apps.html#cb13-2" tabindex="-1"></a>  output<span class="sc">$</span>histogram <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>(</span>
<span id="cb13-3"><a href="5-developing-shiny-apps.html#cb13-3" tabindex="-1"></a>    <span class="at">alt =</span> <span class="st">&quot;Histogram of waiting times&quot;</span>,</span>
<span id="cb13-4"><a href="5-developing-shiny-apps.html#cb13-4" tabindex="-1"></a>    {</span>
<span id="cb13-5"><a href="5-developing-shiny-apps.html#cb13-5" tabindex="-1"></a>      <span class="fu">hist</span>(</span>
<span id="cb13-6"><a href="5-developing-shiny-apps.html#cb13-6" tabindex="-1"></a>        x,</span>
<span id="cb13-7"><a href="5-developing-shiny-apps.html#cb13-7" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">min</span>(x), <span class="fu">max</span>(x),</span>
<span id="cb13-8"><a href="5-developing-shiny-apps.html#cb13-8" tabindex="-1"></a>          <span class="at">length.out =</span> input<span class="sc">$</span>n <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb13-9"><a href="5-developing-shiny-apps.html#cb13-9" tabindex="-1"></a>        ),</span>
<span id="cb13-10"><a href="5-developing-shiny-apps.html#cb13-10" tabindex="-1"></a>        <span class="at">freq =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-11"><a href="5-developing-shiny-apps.html#cb13-11" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;#BB74DB&quot;</span>,</span>
<span id="cb13-12"><a href="5-developing-shiny-apps.html#cb13-12" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb13-13"><a href="5-developing-shiny-apps.html#cb13-13" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Histogram of waiting times&quot;</span>,</span>
<span id="cb13-14"><a href="5-developing-shiny-apps.html#cb13-14" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Waiting time to next eruption [mins]&quot;</span>,</span>
<span id="cb13-15"><a href="5-developing-shiny-apps.html#cb13-15" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Frequency&quot;</span></span>
<span id="cb13-16"><a href="5-developing-shiny-apps.html#cb13-16" tabindex="-1"></a>      )</span>
<span id="cb13-17"><a href="5-developing-shiny-apps.html#cb13-17" tabindex="-1"></a>      <span class="fu">box</span>()</span>
<span id="cb13-18"><a href="5-developing-shiny-apps.html#cb13-18" tabindex="-1"></a>    }</span>
<span id="cb13-19"><a href="5-developing-shiny-apps.html#cb13-19" tabindex="-1"></a>  )</span>
<span id="cb13-20"><a href="5-developing-shiny-apps.html#cb13-20" tabindex="-1"></a>}</span></code></pre></div>
<p>The <code>output</code> object contains the reactive output objects, in our case the
rendered plot. <code>input</code> and <code>output</code> together describe the state of the
app. Changes in <code>input</code> (<code>input$n</code> here) will invalidate reactive objects that
reference these reactive dependencies
and cause the relevant render functions (<code>renderPlot()</code> here) to re-execute.</p>
<p>We can see some differences in the Python version.
Shiny for Python uses decorators (e.g. <code>@output</code>) instead of
render functions and inputs are invoked as <code>input.n()</code>.
(See the <a href="https://shiny.posit.co/py/docs/comp-r-shiny.html">Framework Comparisons</a>
section of the Shiny for Python documentation for a detailed overview of
R vs. Python similarities and differences.)</p>
<p>FIXME: KALVIN please explain here the <code>@output</code> part etc.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="5-developing-shiny-apps.html#cb14-1" tabindex="-1"></a><span class="kw">def</span> server(<span class="bu">input</span>, output, session):</span>
<span id="cb14-2"><a href="5-developing-shiny-apps.html#cb14-2" tabindex="-1"></a>    <span class="at">@output</span></span>
<span id="cb14-3"><a href="5-developing-shiny-apps.html#cb14-3" tabindex="-1"></a>    <span class="at">@render.plot</span>(alt<span class="op">=</span><span class="st">&quot;Histogram of waiting times&quot;</span>)</span>
<span id="cb14-4"><a href="5-developing-shiny-apps.html#cb14-4" tabindex="-1"></a>    <span class="kw">def</span> histogram():</span>
<span id="cb14-5"><a href="5-developing-shiny-apps.html#cb14-5" tabindex="-1"></a>        plt.hist(</span>
<span id="cb14-6"><a href="5-developing-shiny-apps.html#cb14-6" tabindex="-1"></a>            x, </span>
<span id="cb14-7"><a href="5-developing-shiny-apps.html#cb14-7" tabindex="-1"></a>            bins <span class="op">=</span> <span class="bu">input</span>.n(), </span>
<span id="cb14-8"><a href="5-developing-shiny-apps.html#cb14-8" tabindex="-1"></a>            density<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb14-9"><a href="5-developing-shiny-apps.html#cb14-9" tabindex="-1"></a>            color<span class="op">=</span><span class="st">&quot;#BB74DB&quot;</span>,</span>
<span id="cb14-10"><a href="5-developing-shiny-apps.html#cb14-10" tabindex="-1"></a>            edgecolor<span class="op">=</span><span class="st">&quot;white&quot;</span>)</span>
<span id="cb14-11"><a href="5-developing-shiny-apps.html#cb14-11" tabindex="-1"></a>        plt.title(<span class="st">&quot;Histogram of waiting times&quot;</span>)</span>
<span id="cb14-12"><a href="5-developing-shiny-apps.html#cb14-12" tabindex="-1"></a>        plt.xlabel(<span class="st">&quot;Waiting time to next eruption [mins]&quot;</span>)</span>
<span id="cb14-13"><a href="5-developing-shiny-apps.html#cb14-13" tabindex="-1"></a>        plt.ylabel(<span class="st">&quot;Frequency&quot;</span>)</span></code></pre></div>
<p>The server function is called once for each Shiny session.
A new session with a new websocket connection is created every time a web
browser connects to the Shiny application.</p>
</div>
<div id="shiny-express" class="section level3 hasAnchor" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> Shiny Express<a href="5-developing-shiny-apps.html#shiny-express" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Python for Shiny has two different syntax options, Shiny Core that you saw
in the previous sections, and <a href="https://shiny.posit.co/py/docs/express-vs-core.html">Shiny Express</a>.
Shiny Core drew inspiration from the original Shiny for R framework,
but is <em>not</em> a literal port of Shiny for R.
Shiny Expressed was introduced quite recently, and is focused on making it
easier for beginners to use Shiny, and might feel more natural to Python users.</p>
<p>Shiny Core offers the separation between the UI and the server components,
making it easier to organize code for larger Shiny apps.
The server function declaration also helps separating code that should only
run at startup vs. for the sessions.
In Shiny Express, all of the code in the app file is executed for each session.</p>
<p>There is only one Shiny syntax option in R.</p>
</div>
</div>
<div id="organizing-shiny-apps" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Organizing Shiny Apps<a href="5-developing-shiny-apps.html#organizing-shiny-apps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The previously presented <code>faithful</code> app is organized as a single file.
The file contained all the globally scoped declarations at the top,
the definition of the UI object and the server function, and ended
with the Shiny app object. As Shiny apps grow from demo examples to full on
data science projects, the increased complexity will necessitate the
organization of the code. You can organize the code into multiple files,
or even as a package. Let’s see the most common patterns.</p>
<div id="single-file" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Single file<a href="5-developing-shiny-apps.html#single-file" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When Shiny is organized in a single file, the convention is to name it <code>app.R</code>.
This way your IDE (RStudio or VS Code) will recognize that it is a Shiny app.
Apart from this convenience, the file can be named anything, e.g. <code>faithful_app.R</code>.
The single file follows the following structure:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="5-developing-shiny-apps.html#cb15-1" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb15-2"><a href="5-developing-shiny-apps.html#cb15-2" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb15-3"><a href="5-developing-shiny-apps.html#cb15-3" tabindex="-1"></a></span>
<span id="cb15-4"><a href="5-developing-shiny-apps.html#cb15-4" tabindex="-1"></a><span class="co"># Define global variables</span></span>
<span id="cb15-5"><a href="5-developing-shiny-apps.html#cb15-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> [...]</span>
<span id="cb15-6"><a href="5-developing-shiny-apps.html#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="5-developing-shiny-apps.html#cb15-7" tabindex="-1"></a><span class="co"># Define the UI</span></span>
<span id="cb15-8"><a href="5-developing-shiny-apps.html#cb15-8" tabindex="-1"></a>app_ui <span class="ot">&lt;-</span> [...]</span>
<span id="cb15-9"><a href="5-developing-shiny-apps.html#cb15-9" tabindex="-1"></a></span>
<span id="cb15-10"><a href="5-developing-shiny-apps.html#cb15-10" tabindex="-1"></a><span class="co"># Define the server</span></span>
<span id="cb15-11"><a href="5-developing-shiny-apps.html#cb15-11" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb15-12"><a href="5-developing-shiny-apps.html#cb15-12" tabindex="-1"></a>    [...]</span>
<span id="cb15-13"><a href="5-developing-shiny-apps.html#cb15-13" tabindex="-1"></a>}</span>
<span id="cb15-14"><a href="5-developing-shiny-apps.html#cb15-14" tabindex="-1"></a></span>
<span id="cb15-15"><a href="5-developing-shiny-apps.html#cb15-15" tabindex="-1"></a><span class="co"># Assemble the Shiny app</span></span>
<span id="cb15-16"><a href="5-developing-shiny-apps.html#cb15-16" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> app_ui, <span class="at">server =</span> server)</span></code></pre></div>
<p>At the end of the file, we define the Shiny app using <code>shinyApp()</code>.
To run the app in R, we either have to source the <code>app.R</code> or provide the
file name as an argument to the <code>runApp()</code> function, e.g.
<code>runApp("&lt;app-directory&gt;/app.R")</code>.</p>
<p>The Python version takes a very similar form as a single file, usually named
as <code>app.py</code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="5-developing-shiny-apps.html#cb16-1" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb16-2"><a href="5-developing-shiny-apps.html#cb16-2" tabindex="-1"></a><span class="im">from</span> shiny <span class="im">import</span> App, render, ui</span>
<span id="cb16-3"><a href="5-developing-shiny-apps.html#cb16-3" tabindex="-1"></a>[...]</span>
<span id="cb16-4"><a href="5-developing-shiny-apps.html#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="5-developing-shiny-apps.html#cb16-5" tabindex="-1"></a><span class="co"># Define global variables</span></span>
<span id="cb16-6"><a href="5-developing-shiny-apps.html#cb16-6" tabindex="-1"></a>x <span class="op">=</span> [...]</span>
<span id="cb16-7"><a href="5-developing-shiny-apps.html#cb16-7" tabindex="-1"></a></span>
<span id="cb16-8"><a href="5-developing-shiny-apps.html#cb16-8" tabindex="-1"></a><span class="co"># Define the UI</span></span>
<span id="cb16-9"><a href="5-developing-shiny-apps.html#cb16-9" tabindex="-1"></a>app_ui <span class="op">=</span> [...]</span>
<span id="cb16-10"><a href="5-developing-shiny-apps.html#cb16-10" tabindex="-1"></a></span>
<span id="cb16-11"><a href="5-developing-shiny-apps.html#cb16-11" tabindex="-1"></a><span class="co"># Define the server</span></span>
<span id="cb16-12"><a href="5-developing-shiny-apps.html#cb16-12" tabindex="-1"></a><span class="kw">def</span> server(<span class="bu">input</span>, output, session):</span>
<span id="cb16-13"><a href="5-developing-shiny-apps.html#cb16-13" tabindex="-1"></a>    [...]</span>
<span id="cb16-14"><a href="5-developing-shiny-apps.html#cb16-14" tabindex="-1"></a></span>
<span id="cb16-15"><a href="5-developing-shiny-apps.html#cb16-15" tabindex="-1"></a><span class="co"># Assemble the Shiny app</span></span>
<span id="cb16-16"><a href="5-developing-shiny-apps.html#cb16-16" tabindex="-1"></a>app <span class="op">=</span> App(ui <span class="op">=</span> app_ui, server <span class="op">=</span> server)</span></code></pre></div>
<p>You can run the Python Shiny app in your IDE or by using the <code>shiny run</code> command
in the terminal, <code>shiny run --reload --launch-browser &lt;app-directory&gt;/app.py</code>.
This will launch the app in the browser and the server will watch for changes
in the app source code and rerender.</p>
<p>The libraries and global variables will be accessible for all the Shiny sessions
by sourcing the app file when you start the Shiny app.
Variables defined inside the server functions will be defined for each
session. This way, one user’s changes of the slider won’t affect the other
user’s experience. However, if one user changes the globally defined
variables (i.e. using the <code>&lt;&lt;-</code> assignment operator), those changes will be
visible in every user’s session.</p>
</div>
<div id="multiple-files" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Multiple Files<a href="5-developing-shiny-apps.html#multiple-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If your app is a bit more complex, you might have multiple files in
the same directory. By convention, the directory contains at least
a <code>server.R</code> file and <code>ui.R</code> file.</p>
<p>Sometimes, there is a third file called
<code>global.R</code>. The <code>global.R</code> file is used to load packages, data sets,
set variables, or define functions that are available globally.</p>
<p>The directory can also have a <code>www</code> folder inside that can store
assets (files, images, icons). Another folder is called <code>R</code> that can
hold R scripts that are sourced before the app starts up.
This is usually the place to put helper functions and Shiny modules,
which are also functions.
If you prefer, you can use the <code>source()</code> function to explicitly source
files as part of the <code>global.R</code> script. Just don’t put these files in the
<code>R</code> folder to avoid sourcing them twice.</p>
<p>The <code>bananas</code> app is organized into multiple files. Here is how the folder
structure looks like for the R version of the app:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="5-developing-shiny-apps.html#cb17-1" tabindex="-1"></a><span class="ex">bananas/r-shiny</span></span>
<span id="cb17-2"><a href="5-developing-shiny-apps.html#cb17-2" tabindex="-1"></a><span class="ex">├──</span> R</span>
<span id="cb17-3"><a href="5-developing-shiny-apps.html#cb17-3" tabindex="-1"></a><span class="ex">│</span>   └── functions.R</span>
<span id="cb17-4"><a href="5-developing-shiny-apps.html#cb17-4" tabindex="-1"></a><span class="ex">├──</span> bananas-svm.rds</span>
<span id="cb17-5"><a href="5-developing-shiny-apps.html#cb17-5" tabindex="-1"></a><span class="ex">├──</span> bananas.csv</span>
<span id="cb17-6"><a href="5-developing-shiny-apps.html#cb17-6" tabindex="-1"></a><span class="ex">├──</span> dependencies.json</span>
<span id="cb17-7"><a href="5-developing-shiny-apps.html#cb17-7" tabindex="-1"></a><span class="ex">├──</span> global.R</span>
<span id="cb17-8"><a href="5-developing-shiny-apps.html#cb17-8" tabindex="-1"></a><span class="ex">├──</span> server.R</span>
<span id="cb17-9"><a href="5-developing-shiny-apps.html#cb17-9" tabindex="-1"></a><span class="ex">└──</span> ui.R</span></code></pre></div>
<p>The <code>global.R</code> file looks like this:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="5-developing-shiny-apps.html#cb18-1" tabindex="-1"></a><span class="co"># bananas/r-shiny/global.R</span></span>
<span id="cb18-2"><a href="5-developing-shiny-apps.html#cb18-2" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb18-3"><a href="5-developing-shiny-apps.html#cb18-3" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb18-4"><a href="5-developing-shiny-apps.html#cb18-4" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb18-5"><a href="5-developing-shiny-apps.html#cb18-5" tabindex="-1"></a></span>
<span id="cb18-6"><a href="5-developing-shiny-apps.html#cb18-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;bananas.csv&quot;</span>)</span>
<span id="cb18-7"><a href="5-developing-shiny-apps.html#cb18-7" tabindex="-1"></a>x<span class="sc">$</span>ripeness <span class="ot">&lt;-</span> <span class="fu">factor</span>(x<span class="sc">$</span>ripeness, <span class="fu">c</span>(<span class="st">&quot;Under&quot;</span>, <span class="st">&quot;Ripe&quot;</span>, <span class="st">&quot;Very&quot;</span>, <span class="st">&quot;Over&quot;</span>))</span>
<span id="cb18-8"><a href="5-developing-shiny-apps.html#cb18-8" tabindex="-1"></a></span>
<span id="cb18-9"><a href="5-developing-shiny-apps.html#cb18-9" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;bananas-svm.rds&quot;</span>)</span></code></pre></div>
<p>Apart from loading libraries, we read in a CSV file, set factor levels so that
those print in a meaningful order instead of alphabetical. Finally, we load
the model we trained earlier. There is also the file <code>functions.R</code> in the <code>R</code>
folder that gets source automatically.</p>
<p>It is important to note, that functions defined inside the files of the <code>R</code>
folder, or anything the you <code>source()</code> (e.g. <code>source("R/functions.R")</code>) will
be added to the global environment. If you want a sourced file to have
local scope, you can include that for example inside your server function as
<code>source("functions.R", local = TRUE)</code>.</p>
<p>To run this app, you can click the Run App button the the IDE
or use <code>runApp("&lt;app-directory&gt;")</code>. As long as the directory contains
the <code>server.R</code> and the <code>ui.R</code> files.</p>
<p>The choice between single vs. multiple files comes down to personal
preference and the complexity of the Shiny app. You might start
with a single file, but as the file gets larger, you might decide to
save the pieces into their own files.
However, keeping Shiny apps in their own folder is generally a good idea
irrespective of having single or multiple files in the folder. This way,
changing your mind later won’t affect how you run the app. You can just
use the same <code>runApp("&lt;app-directory&gt;")</code> command, if you follow these
basic naming conventions.</p>
<p>We can also split the Python version of the <code>bananas</code> app into multiple files.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="5-developing-shiny-apps.html#cb19-1" tabindex="-1"></a><span class="ex">bananas/py-shiny</span></span>
<span id="cb19-2"><a href="5-developing-shiny-apps.html#cb19-2" tabindex="-1"></a><span class="ex">├──</span> app.py</span>
<span id="cb19-3"><a href="5-developing-shiny-apps.html#cb19-3" tabindex="-1"></a><span class="ex">├──</span> bananas-svm.joblib</span>
<span id="cb19-4"><a href="5-developing-shiny-apps.html#cb19-4" tabindex="-1"></a><span class="ex">├──</span> bananas.csv</span>
<span id="cb19-5"><a href="5-developing-shiny-apps.html#cb19-5" tabindex="-1"></a><span class="ex">├──</span> functions.py</span>
<span id="cb19-6"><a href="5-developing-shiny-apps.html#cb19-6" tabindex="-1"></a><span class="ex">└──</span> requirements.txt</span></code></pre></div>
<p>Sourcing files in Python works slight differently in Python. It is not like
adding scripts inline as you saw for R. But rather it follows the same
namespace pattern as importing from libraries.</p>
<p>These are the first few lines of the <code>app.py</code> file:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="5-developing-shiny-apps.html#cb20-1" tabindex="-1"></a><span class="co"># bananas/py-shiny/app.py</span></span>
<span id="cb20-2"><a href="5-developing-shiny-apps.html#cb20-2" tabindex="-1"></a><span class="im">from</span> shiny <span class="im">import</span> App, render, reactive, ui</span>
<span id="cb20-3"><a href="5-developing-shiny-apps.html#cb20-3" tabindex="-1"></a><span class="im">from</span> functions <span class="im">import</span> <span class="op">*</span></span>
<span id="cb20-4"><a href="5-developing-shiny-apps.html#cb20-4" tabindex="-1"></a>[...]</span></code></pre></div>
<p>We import objects from <code>shiny</code>, then import everything from the <code>functions.py</code>
file. We define plotting helper functions in this file. But we also have to
import libraries used inside <code>functions.py</code> within the scope of that file:</p>
<p>FIXME: KALVIN please clarify this to be clear for python users</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="5-developing-shiny-apps.html#cb21-1" tabindex="-1"></a><span class="co"># bananas/py-shiny/app.py</span></span>
<span id="cb21-2"><a href="5-developing-shiny-apps.html#cb21-2" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb21-3"><a href="5-developing-shiny-apps.html#cb21-3" tabindex="-1"></a>[...]</span></code></pre></div>
<p>To run a Python Shiny app that is in multiple files, you still need to
specify the file that has the Shiny app object defined that you want to run,
<code>shiny run &lt;app-directory&gt;/app.py</code>. Or if the file is called <code>app.py</code> and the
app object is called <code>app</code>, you can use <code>shiny run</code> from the current
working directory.</p>
<p>As Shiny for Python apps become more widespread in the future, we will see
many different patterns emerge with best practices for organizing files.</p>
</div>
<div id="shiny-app-with-nested-files-structure" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Shiny App with Nested Files Structure<a href="5-developing-shiny-apps.html#shiny-app-with-nested-files-structure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Your app can grow more complex over time, and you might find that the
of the multiple-file structure described above to be limiting.
You might have Shiny modules inside Shiny modules. Such a setup might lend itself
to a hierarchical file structure.</p>
<p>If this is the case, you can use the <a href="https://github.com/Appsilon/rhino">Rhino Shiny framework</a>
and the <code>rhino</code> R package <span class="citation">(<a href="#ref-R-rhino">Żyła et al. 2024</a>)</span>. This Shiny framework was inspired by
importing and scoping conventions of the Python and JavaScript languages.
Rhino enforces strong conventions using a nested file structure and modularized
R code. Rhino also uses the <code>box</code> package <span class="citation">(<a href="#ref-R-box">Rudolph 2024</a>)</span> that defines a hierarchical
and composable module system for R.</p>
<p>Here is the directory structure for the Rhino version of the <code>faithful</code> app:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb22-1"><a href="5-developing-shiny-apps.html#cb22-1" tabindex="-1"></a><span class="ex">faithful/r-rhino</span></span>
<span id="cb22-2"><a href="5-developing-shiny-apps.html#cb22-2" tabindex="-1"></a><span class="ex">├──</span> app</span>
<span id="cb22-3"><a href="5-developing-shiny-apps.html#cb22-3" tabindex="-1"></a><span class="ex">│</span>   ├── main.R</span>
<span id="cb22-4"><a href="5-developing-shiny-apps.html#cb22-4" tabindex="-1"></a><span class="ex">│</span>   └── static</span>
<span id="cb22-5"><a href="5-developing-shiny-apps.html#cb22-5" tabindex="-1"></a><span class="ex">│</span>       └── favicon.ico</span>
<span id="cb22-6"><a href="5-developing-shiny-apps.html#cb22-6" tabindex="-1"></a><span class="ex">├──</span> app.R</span>
<span id="cb22-7"><a href="5-developing-shiny-apps.html#cb22-7" tabindex="-1"></a><span class="ex">├──</span> config.yml</span>
<span id="cb22-8"><a href="5-developing-shiny-apps.html#cb22-8" tabindex="-1"></a><span class="ex">├──</span> dependencies.R</span>
<span id="cb22-9"><a href="5-developing-shiny-apps.html#cb22-9" tabindex="-1"></a><span class="ex">└──</span> rhino.yml</span></code></pre></div>
<p>The <code>app/static</code> folder serves a similar purpose to the <code>www</code> folder.
The R code itself is ins the <code>app.R</code> folder, specifically the <code>app/main.R</code> file.
You can see how the import statement is structured at the beginning, and how a
Shiny module is used for the <code>ui</code> and <code>server</code>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="5-developing-shiny-apps.html#cb23-1" tabindex="-1"></a>box<span class="sc">::</span><span class="fu">use</span>(</span>
<span id="cb23-2"><a href="5-developing-shiny-apps.html#cb23-2" tabindex="-1"></a>  shiny[fixedPage, moduleServer, NS, plotOutput, sliderInput, </span>
<span id="cb23-3"><a href="5-developing-shiny-apps.html#cb23-3" tabindex="-1"></a>    renderPlot],</span>
<span id="cb23-4"><a href="5-developing-shiny-apps.html#cb23-4" tabindex="-1"></a>  graphics[hist, box],</span>
<span id="cb23-5"><a href="5-developing-shiny-apps.html#cb23-5" tabindex="-1"></a>  datasets[faithful],</span>
<span id="cb23-6"><a href="5-developing-shiny-apps.html#cb23-6" tabindex="-1"></a>)</span>
<span id="cb23-7"><a href="5-developing-shiny-apps.html#cb23-7" tabindex="-1"></a></span>
<span id="cb23-8"><a href="5-developing-shiny-apps.html#cb23-8" tabindex="-1"></a>x <span class="ot">&lt;-</span> faithful<span class="sc">$</span>waiting</span>
<span id="cb23-9"><a href="5-developing-shiny-apps.html#cb23-9" tabindex="-1"></a></span>
<span id="cb23-10"><a href="5-developing-shiny-apps.html#cb23-10" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb23-11"><a href="5-developing-shiny-apps.html#cb23-11" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="cf">function</span>(id) {</span>
<span id="cb23-12"><a href="5-developing-shiny-apps.html#cb23-12" tabindex="-1"></a>  ns <span class="ot">&lt;-</span> <span class="fu">NS</span>(id)</span>
<span id="cb23-13"><a href="5-developing-shiny-apps.html#cb23-13" tabindex="-1"></a>  <span class="fu">fixedPage</span>(</span>
<span id="cb23-14"><a href="5-developing-shiny-apps.html#cb23-14" tabindex="-1"></a>    [...]</span>
<span id="cb23-15"><a href="5-developing-shiny-apps.html#cb23-15" tabindex="-1"></a>  )</span>
<span id="cb23-16"><a href="5-developing-shiny-apps.html#cb23-16" tabindex="-1"></a>}</span>
<span id="cb23-17"><a href="5-developing-shiny-apps.html#cb23-17" tabindex="-1"></a></span>
<span id="cb23-18"><a href="5-developing-shiny-apps.html#cb23-18" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb23-19"><a href="5-developing-shiny-apps.html#cb23-19" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(id) {</span>
<span id="cb23-20"><a href="5-developing-shiny-apps.html#cb23-20" tabindex="-1"></a>  <span class="fu">moduleServer</span>(id, <span class="cf">function</span>(input, output, session) {</span>
<span id="cb23-21"><a href="5-developing-shiny-apps.html#cb23-21" tabindex="-1"></a>    output<span class="sc">$</span>histogram <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>(</span>
<span id="cb23-22"><a href="5-developing-shiny-apps.html#cb23-22" tabindex="-1"></a>      [...]</span>
<span id="cb23-23"><a href="5-developing-shiny-apps.html#cb23-23" tabindex="-1"></a>    )</span>
<span id="cb23-24"><a href="5-developing-shiny-apps.html#cb23-24" tabindex="-1"></a>  })</span>
<span id="cb23-25"><a href="5-developing-shiny-apps.html#cb23-25" tabindex="-1"></a>}</span></code></pre></div>
<p>To run this app, you can call <code>shiny::runApp()</code>, the <code>app.R</code> file contains a
single line calling <code>rhino::app()</code> which creates the Shiny app object.</p>
<p>The developers of the framework also released a very similar
Python implementation called <a href="https://github.com/Appsilon/tapyr-template">Tapyr</a>.</p>
</div>
<div id="programmatic-cases" class="section level3 hasAnchor" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Programmatic Cases<a href="5-developing-shiny-apps.html#programmatic-cases" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In R, if you want to run the Shiny app as part of another function, you
can supply a <em>list</em> with <code>ui</code> and <code>server</code> components (i.e.
<code>runApp(list(ui = ui, server = server))</code>) or a Shiny <em>app object</em>
created by the <code>shinyApp()</code> function (i.e.
<code>runApp(shinyApp(ui, server))</code>).</p>
<p>Note that when <code>shinyApp()</code> is used at the R console, the Shiny app object
is automatically passed to the <code>print()</code> function, or more specifically, to the
<code>shiny:::print.shiny.appobj</code> function, which runs the app with <code>runApp()</code>.
If <code>shinyApp()</code> is called in the middle of a function, the value will not
be passed to the print method and the app will not be run. That is why you have
to run the app using <code>runApp()</code>. For example, we can write the following
function where <code>app_ui</code> and <code>server</code> are defined above as part of the
single-file <code>faithful</code> Shiny app. The <code>...</code> passes possible other arguments
to <code>runApp</code> such as the <code>host</code> or <code>port</code>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="5-developing-shiny-apps.html#cb24-1" tabindex="-1"></a>run_app <span class="ot">&lt;-</span> <span class="cf">function</span>(...) {</span>
<span id="cb24-2"><a href="5-developing-shiny-apps.html#cb24-2" tabindex="-1"></a>  <span class="fu">runApp</span>(</span>
<span id="cb24-3"><a href="5-developing-shiny-apps.html#cb24-3" tabindex="-1"></a>    <span class="fu">shinyApp</span>(</span>
<span id="cb24-4"><a href="5-developing-shiny-apps.html#cb24-4" tabindex="-1"></a>      <span class="at">ui =</span> app_ui,</span>
<span id="cb24-5"><a href="5-developing-shiny-apps.html#cb24-5" tabindex="-1"></a>      <span class="at">server =</span> server</span>
<span id="cb24-6"><a href="5-developing-shiny-apps.html#cb24-6" tabindex="-1"></a>    ),</span>
<span id="cb24-7"><a href="5-developing-shiny-apps.html#cb24-7" tabindex="-1"></a>    ...</span>
<span id="cb24-8"><a href="5-developing-shiny-apps.html#cb24-8" tabindex="-1"></a>  )</span>
<span id="cb24-9"><a href="5-developing-shiny-apps.html#cb24-9" tabindex="-1"></a>}</span></code></pre></div>
<p>Start the app by typing <code>run_app()</code> into the console.</p>
</div>
<div id="shiny-app-as-an-r-package" class="section level3 hasAnchor" number="5.2.5">
<h3><span class="header-section-number">5.2.5</span> Shiny App as an R Package<a href="5-developing-shiny-apps.html#shiny-app-as-an-r-package" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Extension packages are the fundamental building blocks of the R ecosystem.
Apps can be hosted on the Comprehensive R Archive Network (CRAN), on GitHub, etc.
The tooling around R packages makes checking and testing these packages easy.
If you have R installed, you can run <code>R CMD check &lt;package-name&gt;</code> to test your
package that might include a <code>tests</code> folder with unit tests.</p>
<p>Including Shiny apps in R packages is quite commonplace nowadays. These
apps might aid data visualization, or simplify calculations for not-so-technical
users. Sometimes the Shiny app is not the main feature of a package, but rather it is
more like an extension or a demo. In such cases, you might decide
to put the Shiny app into the <code>inst</code> folder of the package. This will make
the app available after installation, but the app’s code will skip any checks.</p>
<p>A consequence is that some dependencies of the app might not be available,
because that is not verified during standard checks. At the time of installation,
the contents of the <code>inst</code> folder will be copied to the package’s root folder.
Therefore, such an app can be started as e.g. 
<code>shiny::runApp(system.file("app", package = "faithful"))</code>.
This means that there is a package called <code>faithful</code>, and in the <code>inst/app</code> folder
you can find the Shiny app.
FIXME: add here link to the r-package version of the faithful example</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb25-1"><a href="5-developing-shiny-apps.html#cb25-1" tabindex="-1"></a><span class="co"># faithful</span></span>
<span id="cb25-2"><a href="5-developing-shiny-apps.html#cb25-2" tabindex="-1"></a><span class="ex">├──</span> DESCRIPTION</span>
<span id="cb25-3"><a href="5-developing-shiny-apps.html#cb25-3" tabindex="-1"></a><span class="ex">├──</span> LICENSE</span>
<span id="cb25-4"><a href="5-developing-shiny-apps.html#cb25-4" tabindex="-1"></a><span class="ex">├──</span> NAMESPACE</span>
<span id="cb25-5"><a href="5-developing-shiny-apps.html#cb25-5" tabindex="-1"></a><span class="ex">├──</span> R</span>
<span id="cb25-6"><a href="5-developing-shiny-apps.html#cb25-6" tabindex="-1"></a><span class="ex">│</span>   └── run_app.R</span>
<span id="cb25-7"><a href="5-developing-shiny-apps.html#cb25-7" tabindex="-1"></a><span class="ex">├──</span> inst</span>
<span id="cb25-8"><a href="5-developing-shiny-apps.html#cb25-8" tabindex="-1"></a><span class="ex">│</span>   └── app</span>
<span id="cb25-9"><a href="5-developing-shiny-apps.html#cb25-9" tabindex="-1"></a><span class="ex">│</span>       ├── global.R</span>
<span id="cb25-10"><a href="5-developing-shiny-apps.html#cb25-10" tabindex="-1"></a><span class="ex">│</span>       ├── server.R</span>
<span id="cb25-11"><a href="5-developing-shiny-apps.html#cb25-11" tabindex="-1"></a><span class="ex">│</span>       ├── ui.R</span>
<span id="cb25-12"><a href="5-developing-shiny-apps.html#cb25-12" tabindex="-1"></a><span class="ex">│</span>       └── www</span>
<span id="cb25-13"><a href="5-developing-shiny-apps.html#cb25-13" tabindex="-1"></a><span class="ex">│</span>           └── favicon.ico</span>
<span id="cb25-14"><a href="5-developing-shiny-apps.html#cb25-14" tabindex="-1"></a><span class="ex">└──</span> man</span>
<span id="cb25-15"><a href="5-developing-shiny-apps.html#cb25-15" tabindex="-1"></a>    <span class="ex">└──</span> run_app.Rd</span></code></pre></div>
<p>We will not teach you how to write an R package. For that, see R’s official
documentation about <a href="https://cran.r-project.org/doc/FAQ/R-exts.html"><em>Writing R Extensions</em></a>,
or <span class="citation">Hadley and Bryan (<a href="#ref-rpkg-book">2023</a>)</span>. The most important parts of the R package are the functions
inside the <code>R</code> folder and the <code>DESCRIPTION</code> file, that describes the dependencies
of the package:</p>
<pre class="text"><code>Package: faithful
Version: 0.0.1
Title: Old Faithful Shiny App
Author: Peter Solymos
Maintainer: Peter Solymos &lt;[...]&gt;
Description: Old Faithful Shiny app.
Imports: shiny
License: MIT + file LICENSE
Encoding: UTF-8
RoxygenNote: 7.3.1</code></pre>
<p>The <code>inst</code> folder contains the Shiny app, the <code>man</code> folder
has the help page for our <code>run_app</code> function. The <code>run_app.R</code> file has the
following content:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="5-developing-shiny-apps.html#cb27-1" tabindex="-1"></a><span class="co">#&#39; Run the Shiny App</span></span>
<span id="cb27-2"><a href="5-developing-shiny-apps.html#cb27-2" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb27-3"><a href="5-developing-shiny-apps.html#cb27-3" tabindex="-1"></a><span class="co">#&#39; @param ... Arguments passed to `shiny::runApp()`.</span></span>
<span id="cb27-4"><a href="5-developing-shiny-apps.html#cb27-4" tabindex="-1"></a><span class="co">#&#39; @export</span></span>
<span id="cb27-5"><a href="5-developing-shiny-apps.html#cb27-5" tabindex="-1"></a>run_app <span class="ot">&lt;-</span> <span class="cf">function</span>(...) {</span>
<span id="cb27-6"><a href="5-developing-shiny-apps.html#cb27-6" tabindex="-1"></a>  shiny<span class="sc">::</span><span class="fu">runApp</span>(<span class="fu">system.file</span>(<span class="st">&quot;app&quot;</span>, <span class="at">package =</span> <span class="st">&quot;faithful&quot;</span>), ...)</span>
<span id="cb27-7"><a href="5-developing-shiny-apps.html#cb27-7" tabindex="-1"></a>}</span></code></pre></div>
<p>The <code>#'</code> style comments are used to add the documentation next to the function
definition, which describes how other parameters can be passed to the
<code>shiny::runApp</code> function. The <code>@export</code> tag signifies that the <code>run_app</code> function
should be added to the <code>NAMESPACE</code> file by the <code>roxygen2</code> package <span class="citation">(<a href="#ref-R-roxygen2">Wickham et al. 2024</a>)</span>.</p>
<p>Calling <code>R CMD build faithful</code> will build the <code>faithful_0.0.1.tar.gz</code> source file.
You can install this package using <code>install.packages("faithful_0.0.1.tar.gz", repos = NULL)</code> from R
or you can use the R command line utility: <code>R CMD INSTALL faithful_0.0.1.tar.gz</code>.
Once the package is installed, you can call <code>faithful::run_app()</code> to start the
Old Faithful example.</p>
<p>If you want to include the app as part of the package’s functions, place it in the
package’s <code>R</code> folder. In this case, <code>shiny</code> and all other packages will have to
be mentioned in the package’s <code>DESCRIPTION</code> file, that describes the dependencies,
as packages that the package imports from.</p>
<p>Best practices can be found out there, both about <a href="https://r-pkgs.org/">writing R packages</a>
<span class="citation">(<a href="#ref-rpkg-book">Hadley and Bryan 2023</a>)</span>, and about engineering Shiny apps using <span class="citation">(<a href="#ref-Fay2021">Fay et al. 2021</a>)</span>.
You can not only test the underlying functions as part of the package, but you
can apply Shiny specific testing tools, like <code>shinytest2</code> <span class="citation">(<a href="#ref-R-shinytest2">Schloerke 2024</a>)</span>.</p>
<p>An R package provides a structure to follow, and everything becomes
a function. Including Shiny apps in R packages this way is much safer, and this
is the approach that some of the most widely used Shiny development frameworks
took. These are the <code>golem</code> <span class="citation">(<a href="#ref-R-golem">Fay et al. 2023</a>)</span>, and the <code>leprechaun</code> <span class="citation">(<a href="#ref-R-leprechaun">John Coene 2022</a>)</span>
packages.</p>
<div id="golem" class="section level4 hasAnchor" number="5.2.5.1">
<h4><span class="header-section-number">5.2.5.1</span> Golem<a href="5-developing-shiny-apps.html#golem" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The use and benefits of the Golem framework are described in the book
<em>Engineering Production-Grade Shiny Apps</em> by <span class="citation">Fay et al. (<a href="#ref-Fay2021">2021</a>)</span>.
Golem is an opinionated framework for building a production-ready Shiny
apps by providing a series of tools doe developing you app, with an emphasis on
writing Shiny modules.</p>
<p>A Golem app is contained inside an R package.
You’ll have to know how to build a package, but this is the price to pay for
having a mature and trusted tools for testing your package from every aspect.
Let’s review how the Golem structure compares to the previous setup.
We will call this app <code>faithfulGolem</code>:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb28-1"><a href="5-developing-shiny-apps.html#cb28-1" tabindex="-1"></a><span class="co"># faithfulGolem</span></span>
<span id="cb28-2"><a href="5-developing-shiny-apps.html#cb28-2" tabindex="-1"></a><span class="ex">├──</span> DESCRIPTION</span>
<span id="cb28-3"><a href="5-developing-shiny-apps.html#cb28-3" tabindex="-1"></a><span class="ex">├──</span> LICENSE</span>
<span id="cb28-4"><a href="5-developing-shiny-apps.html#cb28-4" tabindex="-1"></a><span class="ex">├──</span> NAMESPACE</span>
<span id="cb28-5"><a href="5-developing-shiny-apps.html#cb28-5" tabindex="-1"></a><span class="ex">├──</span> R</span>
<span id="cb28-6"><a href="5-developing-shiny-apps.html#cb28-6" tabindex="-1"></a><span class="ex">│</span>   ├── app_config.R</span>
<span id="cb28-7"><a href="5-developing-shiny-apps.html#cb28-7" tabindex="-1"></a><span class="ex">│</span>   ├── app_server.R</span>
<span id="cb28-8"><a href="5-developing-shiny-apps.html#cb28-8" tabindex="-1"></a><span class="ex">│</span>   ├── app_ui.R</span>
<span id="cb28-9"><a href="5-developing-shiny-apps.html#cb28-9" tabindex="-1"></a><span class="ex">│</span>   ├── mod_histogram.R</span>
<span id="cb28-10"><a href="5-developing-shiny-apps.html#cb28-10" tabindex="-1"></a><span class="ex">│</span>   └── run_app.R</span>
<span id="cb28-11"><a href="5-developing-shiny-apps.html#cb28-11" tabindex="-1"></a><span class="ex">├──</span> dev</span>
<span id="cb28-12"><a href="5-developing-shiny-apps.html#cb28-12" tabindex="-1"></a><span class="ex">│</span>   ├── 01_start.R</span>
<span id="cb28-13"><a href="5-developing-shiny-apps.html#cb28-13" tabindex="-1"></a><span class="ex">│</span>   ├── 02_dev.R</span>
<span id="cb28-14"><a href="5-developing-shiny-apps.html#cb28-14" tabindex="-1"></a><span class="ex">│</span>   ├── 03_deploy.R</span>
<span id="cb28-15"><a href="5-developing-shiny-apps.html#cb28-15" tabindex="-1"></a><span class="ex">│</span>   └── run_dev.R</span>
<span id="cb28-16"><a href="5-developing-shiny-apps.html#cb28-16" tabindex="-1"></a><span class="ex">├──</span> inst</span>
<span id="cb28-17"><a href="5-developing-shiny-apps.html#cb28-17" tabindex="-1"></a><span class="ex">│</span>   ├── app</span>
<span id="cb28-18"><a href="5-developing-shiny-apps.html#cb28-18" tabindex="-1"></a><span class="ex">│</span>   │   └── www</span>
<span id="cb28-19"><a href="5-developing-shiny-apps.html#cb28-19" tabindex="-1"></a><span class="ex">│</span>   │       └── favicon.ico</span>
<span id="cb28-20"><a href="5-developing-shiny-apps.html#cb28-20" tabindex="-1"></a><span class="ex">│</span>   └── golem-config.yml</span>
<span id="cb28-21"><a href="5-developing-shiny-apps.html#cb28-21" tabindex="-1"></a><span class="ex">└──</span> man</span>
<span id="cb28-22"><a href="5-developing-shiny-apps.html#cb28-22" tabindex="-1"></a>    <span class="ex">└──</span> run_app.Rd</span></code></pre></div>
<p>The most important difference is that we see the UI and server added to the
<code>R</code> folder as functions, instead of plain script files in the <code>inst</code> folder.
The <code>dev</code> folder contains development related boilerplate code and
functions to use when testing the package without the need to reinstall after
every tiny change you make to the Shiny app or the R package in general.
The <code>inst</code> folder has the static content for the app with the <code>www</code> folder
inside.</p>
<p>The <code>DESCRIPTION</code> file looks like this:</p>
<pre class="text"><code>Package: faithfulGolem
Title: Old Faithful Shiny App
Version: 0.0.1
Author: Peter Solymos
Maintainer: Peter Solymos &lt;[...]&gt;
Description: Old Faithful Shiny app.
License: MIT + file LICENSE
Imports: 
    config (&gt;= 0.3.2),
    golem (&gt;= 0.4.1),
    shiny (&gt;= 1.8.1.1)
Encoding: UTF-8
RoxygenNote: 7.3.1</code></pre>
<p>Notice that the <code>config</code> and <code>golem</code> packages are now part of the list of
dependencies with the package versions explicitly mentioned to avoid possible
backwards compatibility issues.</p>
<p>Let’s take a look at the UI and server functions. The <code>app_ui</code> function
returns the UI as a tags list object. You might notice that we use a module UI
function here:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="5-developing-shiny-apps.html#cb30-1" tabindex="-1"></a>app_ui <span class="ot">&lt;-</span> <span class="cf">function</span>(request) {</span>
<span id="cb30-2"><a href="5-developing-shiny-apps.html#cb30-2" tabindex="-1"></a>  <span class="fu">tagList</span>(</span>
<span id="cb30-3"><a href="5-developing-shiny-apps.html#cb30-3" tabindex="-1"></a>    <span class="co"># Leave this function for adding external resources</span></span>
<span id="cb30-4"><a href="5-developing-shiny-apps.html#cb30-4" tabindex="-1"></a>    <span class="fu">golem_add_external_resources</span>(),</span>
<span id="cb30-5"><a href="5-developing-shiny-apps.html#cb30-5" tabindex="-1"></a>    <span class="co"># Your application UI logic</span></span>
<span id="cb30-6"><a href="5-developing-shiny-apps.html#cb30-6" tabindex="-1"></a>    <span class="fu">fixedPage</span>(</span>
<span id="cb30-7"><a href="5-developing-shiny-apps.html#cb30-7" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;Old Faithful&quot;</span>,</span>
<span id="cb30-8"><a href="5-developing-shiny-apps.html#cb30-8" tabindex="-1"></a>      <span class="fu">h2</span>(<span class="st">&quot;Old Faithful&quot;</span>),</span>
<span id="cb30-9"><a href="5-developing-shiny-apps.html#cb30-9" tabindex="-1"></a>      <span class="fu">mod_histogram_ui</span>(<span class="st">&quot;histogram_1&quot;</span>)</span>
<span id="cb30-10"><a href="5-developing-shiny-apps.html#cb30-10" tabindex="-1"></a>    )</span>
<span id="cb30-11"><a href="5-developing-shiny-apps.html#cb30-11" tabindex="-1"></a>  )</span>
<span id="cb30-12"><a href="5-developing-shiny-apps.html#cb30-12" tabindex="-1"></a>}</span></code></pre></div>
<p>The <code>app_server</code> function loads the Old Faithful data set and calls the
histogram module’s server function that uses the same <code>"histogram_1"</code>
identified as the module UI function, plus it also takes the data set as
an argument too:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="5-developing-shiny-apps.html#cb31-1" tabindex="-1"></a>app_server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb31-2"><a href="5-developing-shiny-apps.html#cb31-2" tabindex="-1"></a>  x <span class="ot">&lt;-</span> datasets<span class="sc">::</span>faithful<span class="sc">$</span>waiting</span>
<span id="cb31-3"><a href="5-developing-shiny-apps.html#cb31-3" tabindex="-1"></a>  <span class="fu">mod_histogram_server</span>(<span class="st">&quot;histogram_1&quot;</span>, x)</span>
<span id="cb31-4"><a href="5-developing-shiny-apps.html#cb31-4" tabindex="-1"></a>}</span></code></pre></div>
<p>So what does this module look like? That is what you can find in the
<code>R/mod_histogram.R</code> file that defines the <code>mod_histogram_ui</code> and
<code>mod_histogram_server</code> functions:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="5-developing-shiny-apps.html#cb32-1" tabindex="-1"></a>mod_histogram_ui <span class="ot">&lt;-</span> <span class="cf">function</span>(id) {</span>
<span id="cb32-2"><a href="5-developing-shiny-apps.html#cb32-2" tabindex="-1"></a>  ns <span class="ot">&lt;-</span> <span class="fu">NS</span>(id)</span>
<span id="cb32-3"><a href="5-developing-shiny-apps.html#cb32-3" tabindex="-1"></a>  <span class="fu">tagList</span>(</span>
<span id="cb32-4"><a href="5-developing-shiny-apps.html#cb32-4" tabindex="-1"></a>    <span class="fu">plotOutput</span>(<span class="at">outputId =</span> <span class="fu">ns</span>(<span class="st">&quot;histogram&quot;</span>)),</span>
<span id="cb32-5"><a href="5-developing-shiny-apps.html#cb32-5" tabindex="-1"></a>    <span class="fu">sliderInput</span>(</span>
<span id="cb32-6"><a href="5-developing-shiny-apps.html#cb32-6" tabindex="-1"></a>      <span class="at">inputId =</span> <span class="fu">ns</span>(<span class="st">&quot;n&quot;</span>),</span>
<span id="cb32-7"><a href="5-developing-shiny-apps.html#cb32-7" tabindex="-1"></a>      <span class="at">label =</span> <span class="st">&quot;Number of bins:&quot;</span>,</span>
<span id="cb32-8"><a href="5-developing-shiny-apps.html#cb32-8" tabindex="-1"></a>      <span class="at">min =</span> <span class="dv">1</span>,</span>
<span id="cb32-9"><a href="5-developing-shiny-apps.html#cb32-9" tabindex="-1"></a>      <span class="at">max =</span> <span class="dv">50</span>,</span>
<span id="cb32-10"><a href="5-developing-shiny-apps.html#cb32-10" tabindex="-1"></a>      <span class="at">value =</span> <span class="dv">25</span>,</span>
<span id="cb32-11"><a href="5-developing-shiny-apps.html#cb32-11" tabindex="-1"></a>      <span class="at">ticks =</span> <span class="cn">TRUE</span></span>
<span id="cb32-12"><a href="5-developing-shiny-apps.html#cb32-12" tabindex="-1"></a>    )</span>
<span id="cb32-13"><a href="5-developing-shiny-apps.html#cb32-13" tabindex="-1"></a>  )</span>
<span id="cb32-14"><a href="5-developing-shiny-apps.html#cb32-14" tabindex="-1"></a>}</span>
<span id="cb32-15"><a href="5-developing-shiny-apps.html#cb32-15" tabindex="-1"></a></span>
<span id="cb32-16"><a href="5-developing-shiny-apps.html#cb32-16" tabindex="-1"></a>mod_histogram_server <span class="ot">&lt;-</span> <span class="cf">function</span>(id, x) {</span>
<span id="cb32-17"><a href="5-developing-shiny-apps.html#cb32-17" tabindex="-1"></a>  <span class="fu">moduleServer</span>(id, <span class="cf">function</span>(input, output, session) {</span>
<span id="cb32-18"><a href="5-developing-shiny-apps.html#cb32-18" tabindex="-1"></a>    ns <span class="ot">&lt;-</span> session<span class="sc">$</span>ns</span>
<span id="cb32-19"><a href="5-developing-shiny-apps.html#cb32-19" tabindex="-1"></a>    output<span class="sc">$</span>histogram <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>(</span>
<span id="cb32-20"><a href="5-developing-shiny-apps.html#cb32-20" tabindex="-1"></a>      <span class="at">alt =</span> <span class="st">&quot;Histogram of waiting times&quot;</span>,</span>
<span id="cb32-21"><a href="5-developing-shiny-apps.html#cb32-21" tabindex="-1"></a>      {</span>
<span id="cb32-22"><a href="5-developing-shiny-apps.html#cb32-22" tabindex="-1"></a>        graphics<span class="sc">::</span><span class="fu">hist</span>(</span>
<span id="cb32-23"><a href="5-developing-shiny-apps.html#cb32-23" tabindex="-1"></a>          x,</span>
<span id="cb32-24"><a href="5-developing-shiny-apps.html#cb32-24" tabindex="-1"></a>          <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">min</span>(x), <span class="fu">max</span>(x),</span>
<span id="cb32-25"><a href="5-developing-shiny-apps.html#cb32-25" tabindex="-1"></a>            <span class="at">length.out =</span> input<span class="sc">$</span>n <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb32-26"><a href="5-developing-shiny-apps.html#cb32-26" tabindex="-1"></a>          ),</span>
<span id="cb32-27"><a href="5-developing-shiny-apps.html#cb32-27" tabindex="-1"></a>          <span class="at">freq =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-28"><a href="5-developing-shiny-apps.html#cb32-28" tabindex="-1"></a>          <span class="at">col =</span> <span class="st">&quot;#BB74DB&quot;</span>,</span>
<span id="cb32-29"><a href="5-developing-shiny-apps.html#cb32-29" tabindex="-1"></a>          <span class="at">border =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb32-30"><a href="5-developing-shiny-apps.html#cb32-30" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">&quot;Histogram of waiting times&quot;</span>,</span>
<span id="cb32-31"><a href="5-developing-shiny-apps.html#cb32-31" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&quot;Waiting time to next eruption [mins]&quot;</span>,</span>
<span id="cb32-32"><a href="5-developing-shiny-apps.html#cb32-32" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&quot;Frequency&quot;</span></span>
<span id="cb32-33"><a href="5-developing-shiny-apps.html#cb32-33" tabindex="-1"></a>        )</span>
<span id="cb32-34"><a href="5-developing-shiny-apps.html#cb32-34" tabindex="-1"></a>        graphics<span class="sc">::</span><span class="fu">box</span>()</span>
<span id="cb32-35"><a href="5-developing-shiny-apps.html#cb32-35" tabindex="-1"></a>      }</span>
<span id="cb32-36"><a href="5-developing-shiny-apps.html#cb32-36" tabindex="-1"></a>    )</span>
<span id="cb32-37"><a href="5-developing-shiny-apps.html#cb32-37" tabindex="-1"></a>  })</span>
<span id="cb32-38"><a href="5-developing-shiny-apps.html#cb32-38" tabindex="-1"></a>}</span></code></pre></div>
<p>After building, checking, and installing the <code>faithfulGolem</code> R package,
you’ll be able to start the Shiny app by calling <code>faithfulGolem::run_app()</code> from R.</p>
<p>FIXME: mention where to find the code for faithfulGolem.</p>
</div>
<div id="leprechaun" class="section level4 hasAnchor" number="5.2.5.2">
<h4><span class="header-section-number">5.2.5.2</span> Leprechaun<a href="5-developing-shiny-apps.html#leprechaun" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <code>leprechaun</code> R package <span class="citation">(<a href="#ref-R-leprechaun">John Coene 2022</a>)</span> uses a similar philosophy to
creating Shiny applications as packages. It comes with a full set of
functions that help you with modules, custom CSS, and JavaScript files.
When using this package, you will notice that <code>leprechaun</code> does not become
a dependency in the <code>DESCRIPTION</code> file, unlike in the case of <code>golem</code>.
Apart from this and some organization choices, the two packages and
the workflow provided by them are very similar. Choose that helps you more
in terms of your app’s specific needs.</p>
<p>Say we name the the R package containing the Old Faithful example as
<code>faithfulLeprechaun</code>. The main functions that are defined should be already
familiar:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="5-developing-shiny-apps.html#cb33-1" tabindex="-1"></a><span class="co"># R/ui.R</span></span>
<span id="cb33-2"><a href="5-developing-shiny-apps.html#cb33-2" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="cf">function</span>(req) {</span>
<span id="cb33-3"><a href="5-developing-shiny-apps.html#cb33-3" tabindex="-1"></a>  <span class="fu">fixedPage</span>(</span>
<span id="cb33-4"><a href="5-developing-shiny-apps.html#cb33-4" tabindex="-1"></a>    [...]</span>
<span id="cb33-5"><a href="5-developing-shiny-apps.html#cb33-5" tabindex="-1"></a>  )</span>
<span id="cb33-6"><a href="5-developing-shiny-apps.html#cb33-6" tabindex="-1"></a>}</span>
<span id="cb33-7"><a href="5-developing-shiny-apps.html#cb33-7" tabindex="-1"></a></span>
<span id="cb33-8"><a href="5-developing-shiny-apps.html#cb33-8" tabindex="-1"></a><span class="co"># R/server.R</span></span>
<span id="cb33-9"><a href="5-developing-shiny-apps.html#cb33-9" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb33-10"><a href="5-developing-shiny-apps.html#cb33-10" tabindex="-1"></a>  x <span class="ot">&lt;-</span> datasets<span class="sc">::</span>faithful<span class="sc">$</span>waiting</span>
<span id="cb33-11"><a href="5-developing-shiny-apps.html#cb33-11" tabindex="-1"></a>  output<span class="sc">$</span>histogram <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>(</span>
<span id="cb33-12"><a href="5-developing-shiny-apps.html#cb33-12" tabindex="-1"></a>    [...]</span>
<span id="cb33-13"><a href="5-developing-shiny-apps.html#cb33-13" tabindex="-1"></a>  )</span>
<span id="cb33-14"><a href="5-developing-shiny-apps.html#cb33-14" tabindex="-1"></a>}</span>
<span id="cb33-15"><a href="5-developing-shiny-apps.html#cb33-15" tabindex="-1"></a></span>
<span id="cb33-16"><a href="5-developing-shiny-apps.html#cb33-16" tabindex="-1"></a><span class="co"># R/run.R</span></span>
<span id="cb33-17"><a href="5-developing-shiny-apps.html#cb33-17" tabindex="-1"></a>run <span class="ot">&lt;-</span> <span class="cf">function</span>(...) {</span>
<span id="cb33-18"><a href="5-developing-shiny-apps.html#cb33-18" tabindex="-1"></a>  <span class="fu">shinyApp</span>(</span>
<span id="cb33-19"><a href="5-developing-shiny-apps.html#cb33-19" tabindex="-1"></a>    <span class="at">ui =</span> ui,</span>
<span id="cb33-20"><a href="5-developing-shiny-apps.html#cb33-20" tabindex="-1"></a>    <span class="at">server =</span> server,</span>
<span id="cb33-21"><a href="5-developing-shiny-apps.html#cb33-21" tabindex="-1"></a>    ...</span>
<span id="cb33-22"><a href="5-developing-shiny-apps.html#cb33-22" tabindex="-1"></a>  )</span>
<span id="cb33-23"><a href="5-developing-shiny-apps.html#cb33-23" tabindex="-1"></a>}</span></code></pre></div>
<p>After the package is installed, the way to run the app is to call
the <code>faithfulLeprechaun::run()</code> function.</p>
<p>FIXME: mention where to find the code for faithfulLeprechaun.</p>

</div>
</div>
<div id="dynamic-documents" class="section level3 hasAnchor" number="5.2.6">
<h3><span class="header-section-number">5.2.6</span> Dynamic Documents<a href="5-developing-shiny-apps.html#dynamic-documents" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dynamic documents stem from the <em>literate programming</em> paradigm <span class="citation">(<a href="#ref-Knuth1992">Knuth 1992</a>)</span>,
where natural language (like English) is interspersed with computer code snippets.
Nowadays, dynamic documents are used to create technical reports, slide decks
for presentations, and books, like the one you are reading.</p>
<p>Markdown is a common plain-text format for such dynamic documents, because it
can be compiled into many different formats using <a href="https://pandoc.org/">Pandoc</a>.
R Markdown builds upon previous literate programming examples, e.g. Sweave
that mixes R and <span class="citation">(<a href="#ref-Leisch2002">Leisch 2002</a>)</span>, and the flexibility provided by
Pandoc and the markdown format.</p>
<p>R Markdown contains chunks of embedded R (or other) code between opening
and closing triple backticks. Underneath, you can find the
<code>rmarkdown</code> <span class="citation">(<a href="#ref-R-rmarkdown">Allaire et al. 2024</a>)</span> and <code>knitr</code> <span class="citation">(<a href="#ref-R-knitr">Xie 2024</a>)</span> R packages at work.
A more recent iteration of this idea is <a href="https://quarto.org/">Quarto</a>.
Quarto is an open-source scientific and technical publishing system
that can include code chunks in many different formats frequently used by
data scientists (e.g. R, Python, Julia, Observable).</p>
<p>Both R Markdown and Quarto let you to use Shiny inside the documents
to build lightweight apps without worrying too much about a user interface.
Such interactive HTML documents cannot provide the same flexibility for
designing your apps as a standard Shiny app would, but it works wonders for
simpler use cases. Let’s review how you can use Shiny in R Markdown (<code>.Rmd</code>)
and Quarto (<code>.qmd</code>) documents.</p>
<div id="r-markdown" class="section level4 hasAnchor" number="5.2.6.1">
<h4><span class="header-section-number">5.2.6.1</span> R Markdown<a href="5-developing-shiny-apps.html#r-markdown" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Markdown files usually begin with a <em>header</em> that defines metadata for the
document, like the title, the author, etc. The header is between
tripple dashes (<code>---</code>) and is written in YAML format (YAML stands for
YAML Ain’t Markup Language).</p>
<p>We’d like to include the Old Faithful example in an R Markdown document.
So we create a file called <code>index.Rmd</code>.
In the YAML header we need to specify an output format that produces
HTML, e.g. <code>html_document</code>, and the runtime to be set to <code>shiny</code>:</p>
<pre><code>---
title: &quot;Old Faithful&quot;
output: html_document
runtime: shiny
---</code></pre>
<p>The first code chunk would contain the data set definition and a <code>knitr</code> option
to set the echo to false so we don’t have to set it for every chunk:</p>
<pre><code>```{r include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
x &lt;- faithful$waiting
```</code></pre>
<p>Next comes a code chunk with the slider widget:</p>
<pre><code>```{r}
sliderInput(
  inputId = &quot;n&quot;,
  label = &quot;Number of bins:&quot;,
  min = 1,
  max = 50,
  value = 25,
  ticks = TRUE
)
```</code></pre>
<p>Finally, we render the plot output:</p>
<pre><code>```{r}
renderPlot(
  alt = &quot;Histogram of waiting times&quot;,
  {
    hist(
      x,
      breaks = seq(min(x), max(x), length.out = input$n + 1),
      freq = TRUE,
      col = &quot;#BB74DB&quot;,
      border = &quot;white&quot;,
      main = &quot;Histogram of waiting times&quot;,
      xlab = &quot;Waiting time to next eruption [mins]&quot;,
      ylab = &quot;Frequency&quot;
    )
    box()
  }
)
```</code></pre>
<p>FIXME: where can you find the full document.</p>
<p>The output format can be any format tha creates an HTML file. So for example,
you can use <code>ioslides_presentation</code> to create a slideshow with Shiny widgets
and interactivity. But because Shiny is involved, you need a server to run the
document.</p>
<p>To render and run the document and the app inside it you can use
<code>rmarkdown::run("index.Rmd")</code>. As a result, the <code>rmarkdown</code> package will
extract the code chunks to create a server definition and uses the
<code>index.html</code> output file to stich in the reactive elements.</p>
<p>When you start the document, you will notice that it always renders the document
at startup. Not only that, but it also requires a full document render for each
end user browser session when deployed.
This startup time for the users can be reduced if we render the HTML only once.
Running expensive data import and manipulation tasks only once would also greatly
help the startup times. The runtime for this is called <code>shinyrmd</code>
(or its alias, <code>shiny_prerendered</code>):</p>
<pre><code>---
title: &quot;Old Faithful&quot;
output: flexdashboard::flex_dashboard
runtime: shinyrmd
---</code></pre>
<p>We’ll use the <code>flexdashboard</code> <span class="citation">(<a href="#ref-R-flexdashboard">Aden-Buie et al. 2023</a>)</span> package to give the document
more of a dashboard look and feel.</p>
<p>The execution of pre-rendered Shiny documents is divided into two
execution contexts, the <em>rendering</em> of the user interface and data,
and the <em>serving</em> of the document to the users.</p>
<p>To indicate the rendering context, you can use <code>context="render"</code> chunk option,
but this can be omitted because this is the default context for all R code chunks.
The <code>"render"</code> is analogous of the <code>ui.R</code> file.
For the first chunk, we define <code>context="setup"</code> to mark code that
is shared between the UI and the server. This is analogous to the <code>global.R</code>
file.</p>
<pre><code>```{r context=&quot;setup&quot;,include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
x &lt;- faithful$waiting
```</code></pre>
<p>We put the slider widget in the sidebar using the <code>"render"</code> context:</p>
<pre><code>Column {.sidebar}
-------------------------------------------------------------

```{r context=&quot;render&quot;}
sliderInput(
  inputId = &quot;n&quot;,
  label = &quot;Number of bins:&quot;,
  min = 1,
  max = 50,
  value = 25,
  ticks = TRUE
)
```</code></pre>
<p>The plot output element goes into the main panel, still as part of the <code>"render"</code>
context:</p>
<pre><code>Column
-------------------------------------------------------------

```{r context=&quot;render&quot;}
plotOutput(&quot;histogram&quot;)
```</code></pre>
<p>Finally, we define the <code>"server"</code> context for the reactive output.
This code is run when the interactive document is served and this is the
same code that we would put into the <code>server.R</code> file:</p>
<pre><code>```{r context=&quot;server&quot;}
output$histogram &lt;- renderPlot(
  alt = &quot;Histogram of waiting times&quot;,
  {
    hist(
      x,
      breaks = seq(min(x), max(x), length.out = input$n + 1),
      freq = TRUE,
      col = &quot;#BB74DB&quot;,
      border = &quot;white&quot;,
      main = &quot;Histogram of waiting times&quot;,
      xlab = &quot;Waiting time to next eruption [mins]&quot;,
      ylab = &quot;Frequency&quot;
    )
    box()
  }
)
```</code></pre>
<p>The <code>"render"</code> and <code>"server"</code> contexts are run in separate R sessions.
The first one is run when rendering happens, the second one is run many times,
once for each user. A consequence of this <em>context separation</em> is that you cannot
access variables created in “render” chunks within “server” chunks, and the
other way around.</p>
<p>To render the document, we use <code>rmarkdown::render("index.Rmd")</code>,
then use <code>rmarkdown::run("index.Rmd")</code> to run the dashboard.
You can also set the <code>RMARKDOWN_RUN_PRERENDER</code> environment variable to <code>0</code>
to prevent any pre-rendering from happening, e.g. with
<code>Sys.setenv(RMARKDOWN_RUN_PRERENDER=0)</code>.</p>
<p>You can include Python code chunks in your R Markdown documents. Python code is
evaluated using the <code>reticulate</code> package <span class="citation">(<a href="#ref-R-reticulate">Ushey, Allaire, and Tang 2024</a>)</span>.
But you cannot include Shiny for Python in R Markdown. For that, you have Quarto.</p>
</div>
<div id="quarto-with-r" class="section level4 hasAnchor" number="5.2.6.2">
<h4><span class="header-section-number">5.2.6.2</span> Quarto with R<a href="5-developing-shiny-apps.html#quarto-with-r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Quarto is very similar to R Markdown in many respects. You can think of it as a
generalized version of R Markdown that natively supports different programming
languages to run code chunks. You will find the YAML header familiar.
To use the Shiny runtime, we define <code>server: shiny</code>. The <code>format: html</code> is
means to produce HTML output. The <code>execute</code> part refers to global options,
so for <code>echo: false</code> means that example we don’t want to code to be echoed into
the document. Let’s start with the following header information in a file
called <code>index.qmd</code>:</p>
<pre><code>---
title: &quot;Old Faithful&quot;
execute:
  echo: false
format: html
server: shiny
---</code></pre>
<p>The language is specified after the triple backticks, here <code>{r}</code> means R.
What is different from R Markdown is that chunk options are defined as
special comments prefaced with <code>#|</code> at the top of the code block
instead of following the language declaration inside the curly brackets.</p>
<p>UI elements belong to the render context, which is something we do not have
to specify:</p>
<pre><code>```{r}
plotOutput(&quot;histogram&quot;)
sliderInput(
  inputId = &quot;n&quot;,
  label = &quot;Number of bins:&quot;,
  min = 1,
  max = 50,
  value = 25,
  ticks = TRUE
)
```</code></pre>
<p>The <code>server-start</code> context will share code and data across multiple user sessions.
It will execute when the document is first run and will not re-execute for
every new user. This is like our <code>global.R</code> file.</p>
<pre><code>```{r}
#| context: server-start
x &lt;- faithful$waiting
```</code></pre>
<p>We can set the context to <code>server</code> for the next chunk:</p>
<pre><code>```{r}
#| context: server
output$histogram &lt;- renderPlot(
  alt = &quot;Histogram of waiting times&quot;,
  {
    hist(
      x,
      breaks = seq(min(x), max(x), length.out = input$n + 1),
      freq = TRUE,
      col = &quot;#BB74DB&quot;,
      border = &quot;white&quot;,
      main = &quot;Histogram of waiting times&quot;,
      xlab = &quot;Waiting time to next eruption [mins]&quot;,
      ylab = &quot;Frequency&quot;
    )
    box()
  }
)
```</code></pre>
<p>To render and serve this document we have to use the command
<code>quarto serve index.qmd</code>. Pre-rendering our document to speed up startup
times for the users is really straightforward. We do not have to change
the server type. We only have to first render the document with
<code>quarto render index.qmd</code>. Then we can serve it with a flag that will tell
quarto not to render it again: <code>quarto serve index.qmd --no-render</code>.</p>
<p>If you wanted to split the <code>.qmd</code> file into multiple files corresponding to
the evaluation contexts, you can have the header and the UI definition in
the <code>index.qmd</code> file. Put the code for the <code>server-start</code> context into the
<code>global.R</code> file. The <code>server.R</code> file should return the server function:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="5-developing-shiny-apps.html#cb47-1" tabindex="-1"></a><span class="co"># server.R</span></span>
<span id="cb47-2"><a href="5-developing-shiny-apps.html#cb47-2" tabindex="-1"></a><span class="cf">function</span>(input, output, session) {</span>
<span id="cb47-3"><a href="5-developing-shiny-apps.html#cb47-3" tabindex="-1"></a>  output<span class="sc">$</span>histogram <span class="ot">&lt;-</span> <span class="fu">renderPlot</span>(</span>
<span id="cb47-4"><a href="5-developing-shiny-apps.html#cb47-4" tabindex="-1"></a>    <span class="at">alt =</span> <span class="st">&quot;Histogram of waiting times&quot;</span>,</span>
<span id="cb47-5"><a href="5-developing-shiny-apps.html#cb47-5" tabindex="-1"></a>    {</span>
<span id="cb47-6"><a href="5-developing-shiny-apps.html#cb47-6" tabindex="-1"></a>      <span class="fu">hist</span>(</span>
<span id="cb47-7"><a href="5-developing-shiny-apps.html#cb47-7" tabindex="-1"></a>        x,</span>
<span id="cb47-8"><a href="5-developing-shiny-apps.html#cb47-8" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">min</span>(x), <span class="fu">max</span>(x), <span class="at">length.out =</span> input<span class="sc">$</span>n <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb47-9"><a href="5-developing-shiny-apps.html#cb47-9" tabindex="-1"></a>        <span class="at">freq =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-10"><a href="5-developing-shiny-apps.html#cb47-10" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;#BB74DB&quot;</span>,</span>
<span id="cb47-11"><a href="5-developing-shiny-apps.html#cb47-11" tabindex="-1"></a>        <span class="at">border =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb47-12"><a href="5-developing-shiny-apps.html#cb47-12" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Histogram of waiting times&quot;</span>,</span>
<span id="cb47-13"><a href="5-developing-shiny-apps.html#cb47-13" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Waiting time to next eruption [mins]&quot;</span>,</span>
<span id="cb47-14"><a href="5-developing-shiny-apps.html#cb47-14" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Frequency&quot;</span></span>
<span id="cb47-15"><a href="5-developing-shiny-apps.html#cb47-15" tabindex="-1"></a>      )</span>
<span id="cb47-16"><a href="5-developing-shiny-apps.html#cb47-16" tabindex="-1"></a>      <span class="fu">box</span>()</span>
<span id="cb47-17"><a href="5-developing-shiny-apps.html#cb47-17" tabindex="-1"></a>    }</span>
<span id="cb47-18"><a href="5-developing-shiny-apps.html#cb47-18" tabindex="-1"></a>  )</span>
<span id="cb47-19"><a href="5-developing-shiny-apps.html#cb47-19" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="quarto-with-python" class="section level4 hasAnchor" number="5.2.6.3">
<h4><span class="header-section-number">5.2.6.3</span> Quarto with Python<a href="5-developing-shiny-apps.html#quarto-with-python" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Python version or our Quarto-based Shiny app is very similar to the R version.
No change is headed in the header. The code chunks will have <code>{python}</code>
defined instead of <code>{r}</code>, and of course you have to copy the Python code
inside the chunks.</p>
<pre><code>---
title: &quot;Old Faithful&quot;
execute:
  echo: false
format: html
server: shiny
---</code></pre>
<p>The next chunk contains the setup and loads libraries:</p>
<pre><code>```{python}
import seaborn as sns
import matplotlib.pyplot as plt
from shiny import App, render, ui

faithful = sns.load_dataset(&quot;geyser&quot;)
x = faithful.waiting
```</code></pre>
<p>The UI elements, like the slider input control, come next:</p>
<pre><code>```{python}
ui.input_slider(
        id=&quot;n&quot;,
        label=&quot;Number of bins:&quot;,
        min=1,
        max=50,
        value=25,
        ticks=True)
```</code></pre>
<p>Finally, the rendered plot:</p>
<pre><code>```{python}
@render.plot(alt=&quot;Histogram of waiting times&quot;)
def histogram():
    plt.hist(
        x,
        bins = input.n(),
        density=False, 
        color=&quot;#BB74DB&quot;,
        edgecolor=&quot;white&quot;)
    plt.title(&quot;Histogram of waiting times&quot;)
    plt.xlabel(&quot;Waiting time to next eruption [mins]&quot;)
    plt.ylabel(&quot;Frequency&quot;)
```</code></pre>
<p>Rendering and serving the Python document is the same you used for the R version:
<code>quarto serve index.qmd</code> will do both, so for a pre rendered version, use
<code>quarto render index.qmd</code> first and the serve with the <code>--no-render</code> flag.</p>
</div>
</div>
<div id="shinylive" class="section level3 hasAnchor" number="5.2.7">
<h3><span class="header-section-number">5.2.7</span> Shinylive<a href="5-developing-shiny-apps.html#shinylive" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using <a href="https://shiny.posit.co/py/docs/shinylive.html">Shinylive</a>, you can run
Shiny applications entirely in a web browser, i.e. on the client side, without
the need for a separate server running in R or Python. This is achieved by
R or Python running in the browser. The Python implementation of Shinylive uses
<a href="https://webassembly.org/">WebAssembly (WASM)</a> and <a href="https://pyodide.org/">Pyodide</a>.
WASM is a binary format for compiled programs that can run in a web browser,
whereas Pyodide is a port of Python and many Python packages compiled to WASM.</p>
<div id="python-shinylive" class="section level4 hasAnchor" number="5.2.7.1">
<h4><span class="header-section-number">5.2.7.1</span> Python Shinylive<a href="5-developing-shiny-apps.html#python-shinylive" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We will create Python Shinylive version of the <em>Hello Shiny</em> app following
the <a href="https://github.com/posit-dev/py-shinylive"><code>posit-dev/py-shinylive</code></a> GitHub repository.
First, export the app inside the <code>py-shiny</code> folder with the single-file app
and put the Shinylive version in the <code>py-shinylive</code> folder:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb52-1"><a href="5-developing-shiny-apps.html#cb52-1" tabindex="-1"></a><span class="ex">shinylive</span> export python py-shinylive</span></code></pre></div>
<p>The Shiny live version will consist of <em>static</em> files, which means that we can
copy these files to any static hosting site (like Netlify or GitHub Pages),
and a browser will be able to display the contents irrespective of the
underlying operating system, and without the need to have a Python available.</p>
<p>Can we view the output locally? If you click on the <code>index.html</code> sitting
in the <code>py-shinylive</code> folder, you will most likely get an error in the browser.
To read the error you have to find the <em>developer tools</em> and check the
error messages. You will see something like this:</p>
<pre class="text"><code>Cross-Origin Request Blocked: The Same Origin Policy disallows reading 
the remote resource at file:///[...]/shinylive/shinylive.js. 
(Reason: CORS request not http).</code></pre>
<p>For security reasons, browsers restrict cross-origin HTTP requests initiated from scripts.
But what is this cross-origin resource sharing (<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">CORS</a>)?
If you load the HTML file (like our <code>index.html</code>) from a source, the default CORS
behaviour will expect any other files, like images, or JavaScript/CSS scripts
to have the same <em>origin</em>. By origin, we mean the domain and subdomain.</p>
<p>Now the problem here is that you are viewing a local version of the files,
which will set the protocol part of the URIs to be <code>file://</code> instead of
<code>http://</code> as indicated in the message. Although the folder following the
file protocol is the same, but this is considered as having opaque origins
by most browsers and therefore will be disallowed.</p>
<p>If you want to view the files locally, you do it through a local server.
That way, all files are served from the same scheme and domain (<code>localhost</code>)
and have the same origin.
Start the server as:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb54-1"><a href="5-developing-shiny-apps.html#cb54-1" tabindex="-1"></a><span class="ex">python3</span> <span class="at">-m</span> http.server <span class="at">--directory</span> py-shinylive</span></code></pre></div>
<p>Now visit <code>http://localhost:8000/</code> in your browser, and the CORS error should
be gone (port 8000 is the default port for <code>http.server</code>).</p>
</div>
<div id="r-shinylive" class="section level4 hasAnchor" number="5.2.7.2">
<h4><span class="header-section-number">5.2.7.2</span> R Shinylive<a href="5-developing-shiny-apps.html#r-shinylive" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Shinylive for R uses similar technology built on WebAssembly using the
<a href="https://docs.r-wasm.org/webr/latest/">WebR</a> R package.
Here is how to create an R Shinylive version of the <em>Hello Shiny</em> app
following the <a href="https://github.com/posit-dev/r-shinylive/"><code>posit-dev/r-shinylive</code></a>
GitHub repository using the interactive R console:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="5-developing-shiny-apps.html#cb55-1" tabindex="-1"></a>shinylive<span class="sc">::</span><span class="fu">export</span>(<span class="st">&quot;r&quot;</span>, <span class="st">&quot;r-shinylive&quot;</span>)</span>
<span id="cb55-2"><a href="5-developing-shiny-apps.html#cb55-2" tabindex="-1"></a>httpuv<span class="sc">::</span><span class="fu">runStaticServer</span>(<span class="st">&quot;r-shinylive&quot;</span>)</span></code></pre></div>
<p>The first line compiles the Shiny app that is inside the <code>r-shiny</code> folder into
the Shinylive version in the <code>r-shinylive</code> folder.
The second command will start the server and open the page in the browser.
You will see a random port used on localhost, e.g. <code>http://127.0.0.1:7446</code>.</p>
</div>
<div id="shinylive-in-quarto" class="section level4 hasAnchor" number="5.2.7.3">
<h4><span class="header-section-number">5.2.7.3</span> Shinylive in Quarto<a href="5-developing-shiny-apps.html#shinylive-in-quarto" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can include Shinylive (R or Python) apps in Quarto. For that, we need to
install the <a href="https://github.com/quarto-ext/shinylive">Shinylive quarto extension</a>
inside the Quarto project folder with <code>quarto add quarto-ext/shinylive</code>.</p>
<p>The header of the Quarto document should list the <code>shinylive</code> extension under
<code>filter</code>:</p>
<pre><code>---
title: &quot;Old Faithful&quot;
format: html
filters:
  - shinylive
---</code></pre>
<p>You can include the Shiny application code into a code chunk marked with
<code>{shinylive-r}</code> or <code>{shinylive-python}</code>. Use the comment <code>standalone: true</code>
which tells Quarto that the block contains a complete Shiny app, and not
only parts of it, as we saw before.
For R, we include the full single-file app. The <code>viewerHeight: 500</code> comment is
needed to have enough space for the UI:</p>
<pre><code>```{shinylive-r}
#| standalone: true
#| viewerHeight: 500

[...]
```</code></pre>
<p>The Python version uses <code>{shinylive-python}</code> and the Python version of the
single-file Old Faithful Shiny app:</p>
<pre><code>```{shinylive-python}
#| standalone: true
#| viewerHeight: 500

[...]
```</code></pre>
<p>To view the Quarto document in your browser, use <code>quarto preview index.qmd</code>.
This will work with the R and the Python versions alike.</p>

</div>
</div>
</div>
<div id="running-shiny-apps-locally" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Running Shiny Apps Locally<a href="5-developing-shiny-apps.html#running-shiny-apps-locally" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When you are developing your app locally, you likely want to rin the app to
check the look and see the changes that you’ve made.
In the previous chapter we already used some of the commands needed to
run the code. Let’s review the different ways of running Shiny for R and Python
apps locally.</p>
<p>Running your app locally is necessary for testing. Of course testing goes way
beyond just opening up the app in the browser. We will not cover best practices
for testing your app. If you are interested, you can read about R package based
development in <span class="citation">Fay et al. (<a href="#ref-Fay2021">2021</a>)</span> or check out the documentation for the
<code>shinytest2</code> R package <span class="citation">(<a href="#ref-R-shinytest2">Schloerke 2024</a>)</span>. For testing related the Python version,
see the <a href="https://github.com/Appsilon/tapyr-template">Tapyr</a> project
that used <a href="https://docs.pytest.org/"><code>pytest</code></a> and
<a href="https://playwright.dev/python/docs/running-tests"><code>playwright</code></a>
for validation and testing.</p>
<div id="r-1" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> R<a href="5-developing-shiny-apps.html#r-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When the app is in a single R file, you should name it <code>app.R</code>
just like we did previously for the <code>faithful</code> example.
If you have multiple files, make sure that you have the <code>server.R</code> and <code>ui.R</code>
files in the same directory. If you are using other frameworks, an <code>app.R</code>
file usually serves as an <em>entrypoint</em> that your IDE will recognize.
This way, you can run it easily inside of the RStudio IDE
(Fig. <a href="5-developing-shiny-apps.html#fig:part2-rstudio-r">5.2</a>) or VS Code with the Shiny extension
(Fig. <a href="5-developing-shiny-apps.html#fig:part2-vscode-r">5.3</a>) by pushing the “▷ Run App” button.
Clicking on button would run the app in either a simple browser window
tab inside your IDE, or in a separate browser window, depending on your settings.</p>
<p>Besides the app showing up in the browser, you can also see some messages
appearing in your R console or terminal for Python.
If you inspect the console output, you should see something like this:</p>
<pre class="text"><code>Running Shiny app
-----------------
shiny::runApp(&quot;r-shiny/app.R&quot;, port = 52938)

Loading required package: shiny
shiny devmode - Turning on shiny autoreload. To disable, 
call `options(shiny.autoreload = FALSE)`
This message is displayed once every 8 hours.

Listening on http://127.0.0.1:52938</code></pre>
<p>What does this mean? Pushing the Run App button led to running the
<code>runApp()</code> command. This started a web server on localhost (<code>127.0.0.1</code>)
listening on port <code>52938</code> (your port number might be different).
If you visit the <code>http://127.0.0.1:52938</code> address in your
browser, you should see the Shiny app with the slider and the histogram.
(Stop the app by closing the app window in RStudio or using CTRL+C).</p>
<p>Running the app this way will allow you to keep the server running while
making changes to the app source code. Your changes will trigger a reload
so you can immediately see the results.
You can disable this behavior by turning off the auto-reload option
with <code>options(shiny.autoreload = FALSE)</code>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:part2-rstudio-r"></span>
<img src="images/02/run-faithful-rstudio-r.png" alt="Running an R Shiny app in the RStudio IDE." width="\textwidth" />
<p class="caption">
Figure 5.2: Running an R Shiny app in the RStudio IDE.
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:part2-vscode-r"></span>
<img src="images/02/run-faithful-code-r.png" alt="Running an R Shiny app in the VS Code IDE with the Shiny extension." width="\textwidth" />
<p class="caption">
Figure 5.3: Running an R Shiny app in the VS Code IDE with the Shiny extension.
</p>
</div>
<p>The <code>runApp()</code> function can take different types of arguments to run the
same app. What you saw above was serving the app from the single file.
If you name the single file something else, e.g.
<code>my-app.R</code>, you can provide the path to a single file as
<code>runApp("&lt;app-directory&gt;/my-app.R")</code>.</p>
<p>You can start the Shiny app from the terminal using the command
<code>R -q -e 'runApp("&lt;app-directory&gt;/my-app.R")'</code> where the <code>-q</code> flag means to
suppress the usual opening message, and <code>-e</code> instructs R to execute the
expression following it. You can also specify the
port number as argument, e.g. <code>R -q -e 'runApp(..., path = 8080)'</code> will
start the web server on port <code>8080</code>.</p>
<p>Running these lines will start the Shiny server locally that you can visit in the browser.
To be precise, the <code>shinyApp()</code> R function returns the app object which is
run either by implicitly calling the <code>print()</code> method on it when running
in the R console. You can also pass the app object to the <code>runApp()</code>
function (you can stop the server by CTRL+C).</p>
<pre class="text"><code>R -q -e &#39;shiny::runApp(&quot;r&quot;, port = 8080)&#39;

&gt; shiny::runApp(&quot;r&quot;, port = 8080)
Loading required package: shiny

Listening on http://127.0.0.1:8080</code></pre>
<p>This pattern might be unusual for you if you are using R mostly in interactive
mode through an IDE. You will see this pattern in the next chapters when we call
R from the terminal shell. This is how we can start the web server process in
non-interactive mode.</p>
</div>
<div id="python" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Python<a href="5-developing-shiny-apps.html#python" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can run the Python app from the RStudio IDE
(Fig. <a href="5-developing-shiny-apps.html#fig:part2-rstudio-py">5.4</a>) or VS Code<br />
(Fig. <a href="5-developing-shiny-apps.html#fig:part2-vscode-py">5.5</a>) by pushing the same “▷ Run App” button.
You’ll see something like this in your console with localhost and
a randomly picked and available port number (<code>52938</code>).</p>
<pre class="text"><code>python -m shiny run --port 52938 --reload [...] py-shiny/app.py

INFO: Will watch for changes in these directories: [&#39;py-shiny&#39;]
INFO: Uvicorn running on http://127.0.0.1:52938 (Press CTRL+C to quit)
INFO: Started reloader process [85924] using WatchFiles
INFO: Started server process [85926]
INFO: Waiting for application startup.
INFO: Application startup complete.
INFO: 127.0.0.1:56050 - &quot;GET [...] HTTP/1.1&quot; 200 OK
INFO: (&#39;127.0.0.1&#39;, 56053) - &quot;WebSocket /websocket/&quot; [accepted]
INFO: connection open</code></pre>
<p>Running the Shiny app in Python relies on the <a href="https://www.uvicorn.org/">Uvicorn</a>
web server library that can handle websocket connections.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:part2-rstudio-py"></span>
<img src="images/02/run-faithful-rstudio-py.png" alt="Running a Python Shiny app in the RSudio IDE." width="\textwidth" />
<p class="caption">
Figure 5.4: Running a Python Shiny app in the RSudio IDE.
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:part2-vscode-py"></span>
<img src="images/02/run-faithful-code-py.png" alt="Running a Python Shiny app in the VS Code IDE with the Shiny extension." width="\textwidth" />
<p class="caption">
Figure 5.5: Running a Python Shiny app in the VS Code IDE with the Shiny extension.
</p>
</div>
<p>The other port number (<code>56053</code>) is for the websocket connection
created for the session. If you open another browser window
pointing to <code>http://127.0.0.1:52938</code>, you’ll see another websocket
connection opening for the new session:</p>
<pre class="text"><code># Opening another browser tab
INFO: 127.0.0.1:56194 - &quot;GET / HTTP/1.1&quot; 200 OK
INFO: (&#39;127.0.0.1&#39;, 56196) - &quot;WebSocket /websocket/&quot; [accepted]</code></pre>
<p>Use <code>App(app_ui, server, debug=False)</code> to suppress the messages.</p>
<p>From the terminal, you can run the single app file from the terminal with
<code>shiny run --port 8080 &lt;app-directory&gt;/app.py</code> on port <code>8080</code>.
If you change the output of the <code>App()</code> statement from the default
<code>app = App(...)</code> to <code>faithful_app = App(...)</code>,
you have to define the app as well not just the file:
<code>shiny run &lt;app-directory&gt;/app.py:faithful_app</code>. If the file is called <code>app.py</code>
and the app object is called <code>app</code>, you can omit the file name and use
<code>shiny run</code>, in this case <code>app.py:app</code> is assumed in the current working directory.</p>
<p>Trying to run both the R and Python version on the same port at the same time
will not be possible. If you want to run both, use different port numbers, e.g. 
<code>8080</code> and <code>8081</code>.</p>
<p>The <code>shiny run</code> command starts the app. You can use the <code>--launch-browser</code> flag
to automatically launch the app in a web browser.
The <code>--reload</code> flag means that the Python process restarts and the browser
reloads when you make and save changes to the <code>python/app.py</code> file
(use CTRL+C to stop the process).</p>
</div>
<div id="the-shiny-app-lifecycle" class="section level3 hasAnchor" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> The Shiny App Lifecycle<a href="5-developing-shiny-apps.html#the-shiny-app-lifecycle" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The traditional way of serving Shiny apps involves a server that runs an
R or Python process, and each client connects to this server and keeps an open
websocket connection as long as they are using the application.
Let’s take a closer look at this to better understand what is happening under
the hood.</p>
<p>Shiny for R relies on the <code>httpuv</code> <span class="citation">(<a href="#ref-R-httpuv">Cheng et al. 2024</a>)</span> package to handle connections.
Whenever a new user connects to the Shiny app a new session is started
and communication between the client and the user session will be happening
through the websocket connection. The websocket allows two-way communication
which is the basis of Shiny’s reactivity. The JavaScript code on the client
side can communicate the the R process via this connection.</p>
<p>In Python, the connections are handled by <a href="https://www.uvicorn.org/">Uvicorn</a>,
and the messages – as we saw before – reveal the port numbers used for
the different user sessions.</p>
<p>Why is this important? Because user sessions having their own ports is the
basis for isolating these sessions from one another. Users will not be able
so access data from another session, unless data is leaked through the global
environment (which should be avoided).</p>
<p>The Shiny app life cycle can be described as follows
(Fig. <a href="5-developing-shiny-apps.html#fig:part2-shiny-lifecycle">5.6</a>):</p>
<ul>
<li>Server start: after calling <code>runApp()</code> in R or <code>shiny run</code> for Python, the
<code>httpuv</code> or Uvicorn server is started and is now listening on a random of
a pre-defined port (e.g. <code>8080</code>).</li>
<li>Server ready: the application code is sourced including loading the required
libraries, data sets, everything from the global scope; if users try to connect
to the app before it is ready they will see an error message.</li>
<li>Client connects to the app via the port over HTTP protocol.</li>
<li>New session created: the backend server (<code>httpuv</code> or Uvicorn) starts a user
session and runs the server function inside that session; a websocket
connection is created for two-way communication.</li>
<li>Client-server communication happening while the user is using the app:
the server sends the rendered HTML content to the client, including the
JavaScript code that will communicate with the server to send and receive
data through the websocket connection.</li>
<li>When the client detects that the websocket connection is lost,
it will try to reconnect to the server.</li>
<li>After a certain amount if inactivity, or in the case of disconnected client,
the websocket connection and the user session will get terminated
and the client browser will “gray out”.</li>
</ul>
<p>You can find more information about the Shiny app life cycle in <span class="citation">Granjon (<a href="#ref-Granjon2022">2022</a>)</span>
and <span class="citation">J. Coene (<a href="#ref-coene2021javascript">2021</a>)</span>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:part2-shiny-lifecycle"></span>
<img src="images/02/shiny-app-websocket.png" alt="The Shiny app life cycle with websocket connection." width="80%" />
<p class="caption">
Figure 5.6: The Shiny app life cycle with websocket connection.
</p>
</div>
<p>For Shinylive applications, the lifecycle does not include a websocket
connection, and relies purely on HTTP(S) between the client and the server.
The server will only send the requested resources to the client, and it will not
do any other work. It will just “serve” these static files.
The client browser will do the heavy lifting by rendering the HTML and
running the Web Assembly binary that will take care of the reactivity.
Such an application will not time out until the browser tab is closed.</p>
</div>
</div>
<div id="sharing-the-shiny-app-code" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Sharing the Shiny App Code<a href="5-developing-shiny-apps.html#sharing-the-shiny-app-code" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The source code for the app can be shared with collaborators,
clients, and users. They can run the app themselves if they are savvy
enough. When the audiences of a Shiny app are R or Python users,
it makes sense to share the app as a Gist, a GitHub repository, or a zip file.
However, sharing Shiny apps, this leaves installing dependencies up to the user.
You can email the files or the link to your users, you can even send a
USB drive or a CD ROM in the mail.</p>
<p>The <code>shiny</code> R package comes with a few useful functions that makes sharing
your apps with technical users a bit easier. You can use the <code>runUrl()</code>,
<code>runGitHub()</code>, and <code>runGist()</code> functions to run app from specific URLs,
GitHub repositories, and Gists, respectively. <code>runUrl()</code> can be pointed at
R files or compressed files, such as <code>.zip</code>.</p>
<p>Another option is distributing your R Shiny app as an R package.
This option takes care of dependency management. You can install the R
package from different sources, like GitHub, and you can also have it
hosted on CRAN. However, the recipients will have to be able to install the
package from source, which implies familiarity with R and package management.
Sharing the app source code is a low effort option on your part,
but might be a high effort option for the ones you are sharing your app with.</p>
</div>
<div id="summary-4" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Summary<a href="5-developing-shiny-apps.html#summary-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We reviewed all the different ways of how Shiny apps can be organized during
development, from standalone R and Python applications to being
part of dynamic documents. We also reviewed options for sharing your app’s code
with others. Sharing the app source code has several issues when you are sharing
it with non-technical users. First off, they will have to have an R or Python
runtime environment. Second, they will have to have all the right
dependencies installed, sometimes with specific versions of the libraries.</p>
<p>As you will see in the next chapter, sharing the app as a Docker image
is also an option. This might help with having a runtime environment and
managing dependencies, but again, your users will need to understand and use
Docker that can be often too much to ask for.
So the real reason we are talking about Docker is that it can help you host the
app.</p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-R-flexdashboard" class="csl-entry">
Aden-Buie, Garrick, Carson Sievert, Richard Iannone, JJ Allaire, and Barbara Borges. 2023. <em>Flexdashboard: R Markdown Format for Flexible Dashboards</em>. <a href="https://CRAN.R-project.org/package=flexdashboard">https://CRAN.R-project.org/package=flexdashboard</a>.
</div>
<div id="ref-R-rmarkdown" class="csl-entry">
Allaire, JJ, Yihui Xie, Christophe Dervieux, Jonathan McPherson, Javier Luraschi, Kevin Ushey, Aron Atkins, et al. 2024. <em>Rmarkdown: Dynamic Documents for r</em>. <a href="https://github.com/rstudio/rmarkdown">https://github.com/rstudio/rmarkdown</a>.
</div>
<div id="ref-R-httpuv" class="csl-entry">
Cheng, Joe, Winston Chang, Steve Reid, James Brown, Bob Trower, and Alexander Peslyak. 2024. <em>Httpuv: HTTP and WebSocket Server Library</em>. <a href="https://CRAN.R-project.org/package=httpuv">https://CRAN.R-project.org/package=httpuv</a>.
</div>
<div id="ref-coene2021javascript" class="csl-entry">
Coene, J. 2021. <em>Javascript for r</em>. Chapman &amp; Hall/CRC the r Series. CRC Press. <a href="https://books.google.ch/books?id=ntUxEAAAQBAJ">https://books.google.ch/books?id=ntUxEAAAQBAJ</a>.
</div>
<div id="ref-R-leprechaun" class="csl-entry">
Coene, John. 2022. <em>Leprechaun: Create Simple ’Shiny’ Applications as Packages</em>. <a href="https://CRAN.R-project.org/package=leprechaun">https://CRAN.R-project.org/package=leprechaun</a>.
</div>
<div id="ref-R-golem" class="csl-entry">
Fay, Colin, Vincent Guyader, Sébastien Rochette, and Cervan Girard. 2023. <em>Golem: A Framework for Robust Shiny Applications</em>. <a href="https://CRAN.R-project.org/package=golem">https://CRAN.R-project.org/package=golem</a>.
</div>
<div id="ref-Fay2021" class="csl-entry">
Fay, Colin, Sébastien Rochette, Vincent Guyader, and Cervan Girard. 2021. <em>Engineering Production-Grade <span>Shiny</span> Apps</em>. Chapman &amp; Hall. <a href="https://engineering-shiny.org/">https://engineering-shiny.org/</a>.
</div>
<div id="ref-Granjon2022" class="csl-entry">
Granjon, David. 2022. <em>Outstanding User Interfaces with Shiny</em>. Chapman &amp; Hall. <a href="https://unleash-shiny.rinterface.com/">https://unleash-shiny.rinterface.com/</a>.
</div>
<div id="ref-rpkg-book" class="csl-entry">
Hadley, Wickham, and Jennifer Bryan. 2023. <em>R Packages</em>. 2nd ed. O’Reilly Media, Inc. <a href="https://r-pkgs.org/">https://r-pkgs.org/</a>.
</div>
<div id="ref-Knuth1992" class="csl-entry">
Knuth, Donald. 1992. <em>Literate Programming</em>. Center for the Study of Language; Information—CSLI.
</div>
<div id="ref-Leisch2002" class="csl-entry">
Leisch, Friedrich. 2002. <span>“Sweave, Part i: Mixing r and LaTeX.”</span> <em>R News</em> 2: 28–31.
</div>
<div id="ref-R-box" class="csl-entry">
Rudolph, Konrad. 2024. <em>Box: Write Reusable, Composable and Modular r Code</em>. <a href="https://CRAN.R-project.org/package=box">https://CRAN.R-project.org/package=box</a>.
</div>
<div id="ref-R-shinytest2" class="csl-entry">
Schloerke, Barret. 2024. <em>Shinytest2: Testing for Shiny Applications</em>. <a href="https://CRAN.R-project.org/package=shinytest2">https://CRAN.R-project.org/package=shinytest2</a>.
</div>
<div id="ref-R-reticulate" class="csl-entry">
Ushey, Kevin, JJ Allaire, and Yuan Tang. 2024. <em>Reticulate: Interface to ’Python’</em>. <a href="https://CRAN.R-project.org/package=reticulate">https://CRAN.R-project.org/package=reticulate</a>.
</div>
<div id="ref-R-roxygen2" class="csl-entry">
Wickham, Hadley, Peter Danenberg, Gábor Csárdi, and Manuel Eugster. 2024. <em>Roxygen2: In-Line Documentation for r</em>. <a href="https://CRAN.R-project.org/package=roxygen2">https://CRAN.R-project.org/package=roxygen2</a>.
</div>
<div id="ref-R-knitr" class="csl-entry">
Xie, Yihui. 2024. <em>Knitr: A General-Purpose Package for Dynamic Report Generation in r</em>. <a href="https://yihui.org/knitr/">https://yihui.org/knitr/</a>.
</div>
<div id="ref-R-rhino" class="csl-entry">
Żyła, Kamil, Jakub Nowicki, Leszek Siemiński, Marek Rogala, Recle Vibal, Tymoteusz Makowski, and Rodrigo Basa. 2024. <em>Rhino: A Framework for Enterprise Shiny Applications</em>. <a href="https://CRAN.R-project.org/package=rhino">https://CRAN.R-project.org/package=rhino</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="4-examples.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="6-containerizing-shiny-apps.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/analythium/hosting-shiny-book/edit/main/02-01-a-developing-shiny.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
