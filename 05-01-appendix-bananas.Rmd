# The Bananas Data Set {-#appendix-bananas}

The bananas data set is the product of a home experiment that one of the authors made during the first months of the COVID-19 pandemic.
The data set tracks the ripening colour composition of banana fruits daily over 3 weeks period.
The full data set can be found in the [GitHub repository](https://github.com/psolymos/bananas) and R package `bananas` (`install.packages("bananas", repos = "https://psolymos.r-universe.dev")`). The subset used in the book and the Shiny app constitutes the 6 fruits that were kept at room temperature.

```{r include=FALSE}
options(scipen = 99, digits = 3)
```

The table has the following fields:

- `fruit`: the identifier of the fruit,
- `day`: number between 0 and 20, the number of days since the first set of photographs,
- `ripeness`: the ripeness class of the fruit based in Peter's personal judgement (Under, Ripe, Very, Over),
- `green`, `yellow`, `brown`: colour composition, these 3 values add up to 1 (100%).

The colour composition was determined based on colour mapping the pixel values of the banana fruits and converting the pixel based 2-dimensional area to proportions.

```{r eval=FALSE,echo=FALSE}
bananas <- read.csv("data/bananas.csv")
str(bananas)
```



```{r eval=TRUE,echo=FALSE, results='asis'}
# this marks the beginning of the Appendix, no content here
if(!is_latex_output()){
txt <- ''
} else {
txt <- '
The following summary presents the ripeness (U = Under, R = Ripe, V = Very, O = Over)
and the percentage values of green, yellow, brown colours.
'
}
cat(txt)
```


```{r eval=TRUE, echo=FALSE}
x <- read.csv("data/bananas.csv")
if (!is_latex_output()) {
    reactable(x,
        defaultPageSize = 10,
        showPageSizeOptions = TRUE,
        pageSizeOptions = c(10, 30, 60, 120),
        highlight = TRUE,
        searchable = TRUE,
        striped = TRUE)
} else {
    z <- matrix("", 20, 6)
    rownames(z) <- sort(unique(x$day))
    colnames(z) <- sort(unique(x$fruit))
    for (i in sort(unique(x$day))) {
        for (j in sort(unique(x$fruit))) {
            ij <- x$day == i & x$fruit == j
            # v <- paste0(x$ripeness[ij], " [G=", round(100*x$green[ij]), 
            #     "|Y=", round(100*x$yellow[ij]), "|B=", round(100*x$brown[ij]), "]")
            v <- paste0(substr(x$ripeness[ij], 1, 1), " (", round(100*x$green[ij]), 
                ", ", round(100*x$yellow[ij]), ", ", round(100*x$brown[ij]), ")")
            z[as.character(i),j] <- v
        }
    }
    rownames(z) <- paste0("Day ", sort(unique(x$day)))
    # https://haozhu233.github.io/kableExtra/awesome_table_in_pdf.pdf
    # x[x$fruit == "fruit_14",] |> 
    z |>
    kbl(booktabs = TRUE,
        longtable = TRUE) |>
    kable_styling(
        font_size = 8,
        latex_options = c("striped", "repeat_header"))
}
```
